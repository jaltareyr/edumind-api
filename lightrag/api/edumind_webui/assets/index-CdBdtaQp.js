import{a4 as fe,d as ge,g as $,a5 as Kt,a6 as W,a7 as g,a8 as i,x as r,a9 as X,y as p,aa as V,Z as O,a2 as b,F as Z,ab as re,u as h,n as _t,ac as oe,w as se,h as Y,R as Ae,V as Jt,U as Yt,ad as tt,D as Zt,H as ue,ae as Fe,A as We,B as Ge,K as es,af as Ds,J as Ns,L as Ps,ag as Ms,ah as Os,ai as Ls}from"./vendor-BCf83v6j.js";import{u as wt,a as kt,c as Us,b as qs}from"./vue-core-CTWTVQ19.js";import{D as Je,M as Gs,a as zs,S as Ws,N as Qs,b as Rs,d as js,E as Bs,e as Hs,l as Xs,F as Ks}from"./graph-vendor-jDRMw3mj.js";import{V as Js,a as we,b as G,c as ot,d as Ys,e as Zs,f as Re,g as Be,h as pe,i as st,j as ce,k as ie,l as je,m as ts,n as Ee,o as le,p as Qe,q as me,r as De,s as Ce,t as _e,u as Le,v as be,w as ye,x as at,y as ea,z as ve,A as $e,B as ss,C as as,D as ta,E as sa,F as aa,G as ra,H as oa,I as rs,J as Ye,K as os,L as Ze,M as ia,N as na,O as la,P as da,Q as Nt,R as ca,S as ua,T as Pt,U as pa,W as ma,X as fa}from"./vuetify-vendor-BQrVyJui.js";import{P as Mt}from"./prism-vendor-BAYahcN8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const n of l.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();const Oe=fe("app",{state:()=>({appName:"EduMind Question Studio",tagline:"Craft rich assessments with adaptive AI support.",organization:"EduMind",themePreference:"light",maxCanvasTabs:5}),getters:{organizationInitials:e=>e.organization.split(" ").map(t=>t.charAt(0)).join("").toUpperCase()},actions:{toggleThemePreference(){this.themePreference=this.themePreference==="light"?"dark":"light"}}}),is="http://localhost:9621".replace(/\/+$/,""),ha="b3b92c76-12c7-4b9d-9778-a90833e52e2d",Ot="default",St="edumind_access_token",ga="edumind_auth_mode";function ns(e){sessionStorage.setItem(St,e)}function He(){return sessionStorage.getItem(St)||""}function ya(){sessionStorage.removeItem(St)}function rt(e){sessionStorage.setItem(ga,e)}function xt(e){try{const[,t]=e.split("."),s=JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")));return s!=null?s:null}catch{return null}}function ls(e,t=15){const s=xt(e);return s!=null&&s.exp?Math.floor(Date.now()/1e3)>=s.exp-t:!1}function va(e){const t=new Headers(e),s=He();return s&&t.set("Authorization",`Bearer ${s}`),t.set("X-API-Key",ha),!t.has("X-Workspace")&&Ot&&t.set("X-Workspace",Ot),t}async function ba(){const e=await fetch(`${is}/auth-status`,{method:"GET"});if(!e.ok)throw new Error(`auth-status failed: ${e.status}`);return e.json()}function bt(){var o;const e=He();if(!e||ls(e))return null;const t=xt(e);return!t||!t.sub?null:{id:(t.metadata||{}).user_id,username:t.sub,full_name:t.sub,role:(o=t.role)!=null?o:"user",exp:typeof t.exp=="number"?t.exp:void 0}}async function _a(){const e=He();if(e&&!ls(e)){const s=bt();if(s)return{user:s}}const t=await ba();return(t==null?void 0:t.auth_configured)===!1&&(t!=null&&t.access_token)?(ns(t.access_token),rt("disabled"),{user:bt()}):(rt("enabled"),{user:null})}async function wa({username:e,password:t}){var n;const s=new URLSearchParams({grant_type:"password",username:e,password:t,scope:"",client_id:"",client_secret:""}),a=await fetch(`${is}/login`,{method:"POST",headers:va({"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}),body:s});if(!a.ok)throw a.status===401?new Error("Incorrect credentials"):new Error(`Login failed: ${a.status}`);const o=await a.json();if(!(o!=null&&o.access_token))throw new Error("No access_token in response");return ns(o.access_token),rt((n=o.auth_mode)!=null?n:"enabled"),{user:bt()}}async function ds(){ya(),rt("enabled")}const ka=3e5,Ct=()=>{const e="http://localhost:9621";return e.endsWith("/")?e.slice(0,-1):e},Sa=(e,t)=>{if(!t)return e;const s=typeof e=="string"?new URL(e,window.location.origin):new URL(e.toString());return Object.entries(t).forEach(([a,o])=>{o==null||o===""||(Array.isArray(o)?o.forEach(l=>s.searchParams.append(a,l)):typeof o=="object"?s.searchParams.append(a,JSON.stringify(o)):s.searchParams.append(a,o))}),s},xa=async e=>{if((e.headers.get("content-type")||"").includes("application/json")){const a=await e.json();if(!e.ok){const o=new Error((a==null?void 0:a.message)||e.statusText);throw o.status=e.status,o.payload=a,o}return a}const s=await e.text();if(!e.ok){const a=new Error(s||e.statusText);throw a.status=e.status,a.payload=s,a}return s},Ca="edumind_access_token",cs=()=>sessionStorage.getItem(Ca)||"";function Lt(){const e=He();if(!e)return null;const t=xt(e);return t?t.metadata&&t.metadata.user_id?t.metadata.user_id:"not found":null}const te=async(e,t={})=>{var L,F,u,f,v;const{method:s="GET",baseUrl:a=Ct(),query:o,headers:l,body:n,timeout:d=ka,signal:c,auth:m={}}=t,y=new AbortController,k=setTimeout(()=>y.abort(),d);c&&(c.aborted?y.abort(c.reason):c.addEventListener("abort",()=>y.abort(c.reason),{once:!0}));const x=((L=m.userId)!=null?L:Lt())||null,T={...o||{},...(o==null?void 0:o.user_id)===void 0&&x?{user_id:x}:{}},_=Sa(`${a}${e}`,T),A=typeof FormData!="undefined"&&n instanceof FormData,P=typeof URLSearchParams!="undefined"&&n instanceof URLSearchParams,N=new Headers({Accept:"application/json",...l});A||(P?N.has("Content-Type")||N.set("Content-Type","application/x-www-form-urlencoded"):n!==void 0&&!N.has("Content-Type")&&N.set("Content-Type","application/json"));const S=(F=m.token)!=null?F:cs();S&&N.set("Authorization",`Bearer ${S}`),((u=m.apiKey)==null||u)&&N.set("X-API-Key",(f=m.apiKey)!=null?f:"b3b92c76-12c7-4b9d-9778-a90833e52e2d");const D=(v=m.workspace)!=null?v:void 0;D&&N.set("X-Workspace",D),Lt(),m.userId&&N.set("X-User-ID",m.userId);const q={method:s,headers:N,body:A||P?n:n!==void 0?JSON.stringify(n):void 0,signal:y.signal};try{const I=await fetch(_.toString(),q);return clearTimeout(k),await xa(I)}catch(I){if(clearTimeout(k),I.name==="AbortError"){const M=new Error("Request timed out or was aborted");throw M.aborted=!0,M}throw I}},Ne=(e={})=>Object.fromEntries(Object.entries(e).filter(([,t])=>t!=null)),At="/documents",It=e=>Ne(e),Aa=({file:e,metadata:t={},query:s,headers:a}={})=>{if(!e)throw new Error("uploadDocument requires a file parameter");const o=new FormData;return o.append("file",e),Object.entries(t).forEach(([l,n])=>{n!=null&&o.append(l,n)}),te(`${At}/upload`,{method:"POST",query:It(s),headers:a,body:o})},Ia=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("insertLinks requires a payload parameter");return te(`${At}/links`,{method:"POST",query:It(t),headers:s,body:e})},Ta=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("getPaginatedDocuments requires a payload parameter");return te(`${At}/paginated`,{method:"POST",query:It(t),headers:s,body:e})},Tt="/questions",us=e=>Ne(e),ps=({query:e,headers:t}={})=>te(`${Tt}/`,{method:"GET",query:us(e),headers:t}),Va=({id:e,query:t,headers:s}={})=>{if(!e)throw new Error("deleteQuestion requires an id parameter");return te(`${Tt}/${encodeURIComponent(e)}`,{method:"DELETE",query:us(t),headers:s})},Ea=async({payload:e,headers:t}={})=>{if(!e)throw new Error("exportQuestions requires a payload parameter");const s=Ct(),a=He(),o=new Headers(t);return o.set("Content-Type","application/json"),a&&o.set("Authorization",`Bearer ${a}`),await fetch(`${s}${Tt}/export`,{method:"POST",headers:o,body:JSON.stringify(e),responseType:"blob"})},ms="/ai",fs=e=>Ne(e),$a=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("generateQuestions requires a payload parameter");return te(`${ms}/questions/generate`,{method:"POST",query:fs(t),headers:s,body:e})},Fa=({questionId:e,payload:t,query:s,headers:a}={})=>{if(!e)throw new Error("generateQuestionVariants requires a questionId parameter");if(!t)throw new Error("generateQuestionVariants requires a payload parameter");return te(`${ms}/questions/${encodeURIComponent(e)}/variants`,{method:"POST",query:fs(s),headers:a,body:t})},hs="/agent",gs=e=>Ne(e),Da=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("generateContent requires a payload parameter");if(!e.requirements)throw new Error("generateContent requires requirements in payload");return te(`${hs}/generate`,{method:"POST",query:gs(t),headers:s,body:e})},Na=({query:e,headers:t}={})=>te(`${hs}/status`,{method:"GET",query:gs(e),headers:t}),it="/sessions",nt=e=>Ne(e),ys=(e={})=>({id:e.id,name:e.topic||"Untitled Canvas",topic:e.topic||"Untitled Canvas",userId:e.user_id,projectId:e.project_id,memoryState:Array.isArray(e.memory_state)?e.memory_state:[],createdAt:e.created_at,lastActiveAt:e.last_active_at}),Pa=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("createSession requires a payload parameter");return te(it,{method:"POST",query:nt(t),headers:s,body:e})},vs=({query:e,headers:t}={})=>te(it,{method:"GET",query:nt(e),headers:t}),Ma=({id:e,query:t,headers:s}={})=>{if(!e)throw new Error("getSession requires an id parameter");return te(`${it}/${encodeURIComponent(e)}`,{method:"GET",query:nt(t),headers:s})},Oa=({id:e,query:t,headers:s}={})=>{if(!e)throw new Error("deleteSession requires an id parameter");return te(`${it}/${encodeURIComponent(e)}`,{method:"DELETE",query:nt(t),headers:s})},La=async({projectId:e,userId:t,limit:s=5,query:a={},headers:o}={})=>{var d,c;const l=await vs({query:{...a,project_id:e!=null?e:a.project_id,user_id:t!=null?t:a.user_id,limit:(d=a.limit)!=null?d:s,sort:(c=a.sort)!=null?c:"-created_at"},headers:o}),n=Array.isArray(l==null?void 0:l.sessions)?l.sessions:[];return{...l,canvases:n.map(m=>ys(m))}},Ua=async({id:e,query:t,headers:s}={})=>{if(!e)throw new Error("fetchCanvas requires an id parameter");const a=await Ma({id:e,query:t,headers:s}),o=a!=null&&a.session?ys(a.session):null;return{...a,canvas:o}},lt="/workspaces",dt=e=>Ne(e),qa=({payload:e,query:t,headers:s}={})=>{if(!e)throw new Error("createWorkspace requires a payload parameter");return te(lt,{method:"POST",query:dt(t),headers:s,body:e})},Ga=({query:e,headers:t}={})=>te(lt,{method:"GET",query:dt(e),headers:t}),za=({id:e,payload:t,query:s,headers:a}={})=>{if(!e)throw new Error("updateWorkspace requires an id parameter");if(!t)throw new Error("updateWorkspace requires a payload parameter");return te(`${lt}/${encodeURIComponent(e)}`,{method:"PATCH",query:dt(s),headers:a,body:t})},Wa=({id:e,query:t,headers:s}={})=>{if(!e)throw new Error("deleteWorkspace requires an id parameter");return te(`${lt}/${encodeURIComponent(e)}`,{method:"DELETE",query:dt(t),headers:s})},Qa=new TextDecoder,Ra=async({payload:e,headers:t={},query:s,signal:a,onChunk:o})=>{const l=Ct(),n=new URL(`${l}/query/stream`,window.location.origin);s&&Object.entries(s).forEach(([_,A])=>{A!=null&&A!==""&&n.searchParams.append(_,A)});const d=new AbortController;[a,d.signal].filter(Boolean);const c=_=>d.abort(_);a&&(a.aborted?d.abort(a.reason):a.addEventListener("abort",()=>c(a.reason),{once:!0}));const m=await fetch(n.toString(),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${cs()}`,...t},body:JSON.stringify(e),signal:d.signal});if(!m.ok){const _=await m.text(),A=new Error(_||m.statusText);throw A.status=m.status,A}if(!m.body||typeof m.body.getReader!="function"){const _=await m.text();typeof o=="function"&&o(_);return}const y=m.body.getReader();let k="";const x=_=>{var N,S,D,q,L,F,u,f;if(!_||_==="[DONE]"||_==="data: [DONE]")return;let A=_;if(A.startsWith("data:")&&(A=A.slice(5).trim(),!A))return;let P="";try{const v=JSON.parse(A);P=(f=(u=(D=(S=(N=v==null?void 0:v.response)!=null?N:v==null?void 0:v.delta)!=null?S:v==null?void 0:v.content)!=null?D:v==null?void 0:v.text)!=null?u:(F=(L=(q=v==null?void 0:v.choices)==null?void 0:q[0])==null?void 0:L.delta)==null?void 0:F.content)!=null?f:"",Array.isArray(P)&&(P=P.join(" "))}catch{P=A}typeof P=="string"&&P&&typeof o=="function"&&o(P)},T=()=>{let _;for(;(_=k.indexOf(`
`))!==-1;){const A=k.slice(0,_).trim();k=k.slice(_+1),x(A)}};try{for(;;){const{value:_,done:A}=await y.read();if(A)break;_&&(k+=Qa.decode(_,{stream:!0}),T())}k=k.trim(),k&&(x(k),k="")}finally{y.releaseLock()}},ja="/graph",bs=e=>Ne(e),Ba=({query:e,headers:t}={})=>te("/graphs",{method:"GET",query:bs(e),headers:t}),Ha=({query:e,headers:t}={})=>te(`${ja}/label/list`,{method:"GET",query:bs(e),headers:t}),Ut=()=>({searchQuery:"",type:"all",difficulty:"all",tag:"all",workspaceId:"all",sessionId:"all",approved:"all",archived:"false",hasVariants:"all"}),qt=e=>!e||e==="all"?{}:{"X-Workspace":e},Xa=(e=[])=>Array.isArray(e)?e.map(t=>{if(!t)return null;const s=Array.isArray(t.options)?t.options.map(l=>String(l)):[],a=t.correct_answers||t.correctIndexes||t.correct_indexes,o=Array.isArray(a)?a.map(l=>Number(l)).filter(l=>!Number.isNaN(l)):[];return{id:t.id||null,difficulty_level:t.difficulty_level||t.difficultyLevel||null,options:s,correct_answers:o,rationale:t.rationale||t.ai_rational||""}}).filter(t=>t!==null):[],Ka=e=>{if(!e||typeof e!="object")return null;const t=Array.isArray(e.tags)?e.tags.map(s=>String(s)):typeof e.tag=="string"?[e.tag]:[];return{id:e.id,type:e.type||"mcq",question:e.question_text||"",options:Array.isArray(e.options)?e.options.map(s=>String(s)):[],correct_options:Array.isArray(e.correct_answers)?e.correct_answers.map(s=>Number(s)):[],difficulty_level:e.difficulty_level||"medium",ai_rational:e.ai_rational||e.rationale||"AI generated question.",source:e.source||"AI Generator",type:e.type||"mcq",tag:t.length?t[0]:"Untagged",tags:t,isApproved:!!e.isApproved,isArchived:!!e.isArchived,project_id:e.project_id||"",session_id:e.session_id||"",created_at:e.created_at||"",updated_at:e.updated_at||"",variants:Xa(e.variants)}},Ja=fe("questions",{state:()=>({questions:[],totalQuestions:0,page:1,pageSize:20,loading:!1,error:null,filters:Ut(),sessionsByWorkspace:{},sessionsLoading:!1,exportDialogOpen:!1,exportFormat:"csv",exportFileName:"questions_export",exporting:!1}),getters:{uniqueTags(e){const t=new Set;return e.questions.forEach(s=>{Array.isArray(s.tags)&&s.tags.length?s.tags.forEach(a=>t.add(a)):s.tag&&t.add(s.tag)}),Array.from(t).sort((s,a)=>s.localeCompare(a))},filteredQuestions(e){const t=e.filters.searchQuery.trim().toLowerCase();return e.questions.filter(s=>{var T;const a=!t||s.question.toLowerCase().includes(t),o=e.filters.type==="all"||s.type===e.filters.type,l=e.filters.difficulty==="all"||s.difficulty_level===e.filters.difficulty,n=e.filters.tag==="all"||s.tag===e.filters.tag||((T=s.tags)==null?void 0:T.includes(e.filters.tag)),d=e.filters.workspaceId==="all"||s.project_id===e.filters.workspaceId,c=e.filters.sessionId==="all"||s.session_id===e.filters.sessionId,m=e.filters.approved==="all"||s.isApproved===(e.filters.approved==="true"),y=e.filters.archived==="all"||s.isArchived===(e.filters.archived==="true"),k=Array.isArray(s.variants)?s.variants.length:0,x=e.filters.hasVariants==="all"||(e.filters.hasVariants==="true"?k>0:k===0);return a&&o&&l&&n&&d&&c&&m&&y&&x})},pageCount(e){return e.totalQuestions?Math.max(1,Math.ceil(e.totalQuestions/e.pageSize)):1},resultsSummary(){const e=this.filteredQuestions.length;if(e===0)return"No questions match the current filters.";const t=(this.page-1)*this.pageSize+1,s=t+e-1;return this.totalQuestions?`Showing ${t}-${s} of ${this.totalQuestions} questions (filtered view).`:e===1?"1 question matches the current filters.":`${e} questions match the current filters.`},sessionsForWorkspace(e){return t=>e.sessionsByWorkspace[t]||[]}},actions:{resetFilters(){this.filters=Ut(),this.page=1},setSearchQuery(e){this.filters.searchQuery=e,this.page=1},setFilterType(e){this.filters.type=e,this.page=1},setFilterDifficulty(e){this.filters.difficulty=e,this.page=1},setFilterTag(e){this.filters.tag=e,this.page=1},setFilterWorkspace(e){this.filters.workspaceId=e||"all",e==="all"&&(this.filters.sessionId="all"),this.page=1},setFilterSession(e){this.filters.sessionId=e||"all",this.page=1},setFilterApproved(e){this.filters.approved=e||"all",this.page=1},setFilterArchived(e){this.filters.archived=e||"all",this.page=1},setFilterHasVariants(e){this.filters.hasVariants=e||"all",this.page=1},setFilterHasVariants(e){this.filters.hasVariants=e||"all",this.page=1},normaliseQuestions(e){return(Array.isArray(e)?e:[]).map(s=>Ka(s)).filter(s=>s!==null)},setPage(e){const t=Number(e);if(!Number.isFinite(t))return;const s=Math.max(1,Math.floor(t));s!==this.page&&(this.page=s)},setPageSize(e){const t=Number(e);[20,40,60,80,100].includes(t)&&t!==this.pageSize&&(this.pageSize=t,this.page=1)},async fetchQuestions(){const{searchQuery:e,workspaceId:t,sessionId:s,approved:a,archived:o,type:l,hasVariants:n}=this.filters,d={page:this.page,pageSize:this.pageSize,sort:"updated_at",order:"desc",q:e||void 0,project_id:t!=="all"?t:void 0,session_id:s!=="all"?s:void 0,isApproved:a==="all"?void 0:a==="true",isArchived:o==="all"?void 0:o==="true",type:l!=="all"?l:void 0,hasVariants:n==="all"?void 0:n==="true"};this.loading=!0,this.error=null;try{const c=await ps({query:d,headers:qt(t!=="all"?t:void 0)}),m=this.normaliseQuestions(c==null?void 0:c.questions);this.questions=m;const y=Number(c==null?void 0:c.total)||m.length;this.totalQuestions=y,c!=null&&c.page&&(this.page=c.page),c!=null&&c.pageSize&&(this.pageSize=c.pageSize)}catch(c){console.error("Failed to load questions",c),this.error=c,this.questions=[],this.totalQuestions=0}finally{this.loading=!1}},async fetchSessionsForWorkspace(e){const t=e||"all";if(t==="all")return[];if(Array.isArray(this.sessionsByWorkspace[t])&&this.sessionsByWorkspace[t].length>0)return this.sessionsByWorkspace[t];this.sessionsLoading=!0;try{const s=await vs({query:{project_id:t,limit:100,sort:"-created_at"},headers:qt(t)}),a=Array.isArray(s==null?void 0:s.sessions)?s.sessions.map(o=>({id:o.id,name:o.topic||"Untitled Canvas",project_id:o.project_id})):[];return this.sessionsByWorkspace={...this.sessionsByWorkspace,[t]:a},this.filters.sessionId!=="all"&&(a.some(l=>l.id===this.filters.sessionId)||(this.filters.sessionId="all")),a}catch(s){return console.error("Failed to load sessions for workspace",s),this.error=s,this.sessionsByWorkspace={...this.sessionsByWorkspace,[t]:[]},[]}finally{this.sessionsLoading=!1}},openExportDialog(){this.exportDialogOpen=!0},closeExportDialog(){this.exportDialogOpen=!1},setExportFormat(e){this.exportFormat=e;const t=e==="qti"?"zip":"csv";this.exportFileName=`questions_export.${t}`},async exportQuestions(){var e;try{const t=this.filteredQuestions;this.exporting=!0;const s={filename:this.exportFileName.replace(/\.(csv|zip)$/i,""),fileformat:this.exportFormat,questions:t.map(c=>({question:c.question+(c.source?` (Source: ${c.source})`:""),options:c.options,correct_options:c.correct_options}))},a=await Ea({payload:s}),o=await a.blob(),l=a.headers.get("Content-Disposition"),n=((e=l==null?void 0:l.split("filename=")[1])==null?void 0:e.replace(/["']/g,""))||`${this.exportFileName}.${this.exportFormat}`,d=document.createElement("a");d.href=URL.createObjectURL(o),d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(d.href)}catch(t){console.error("Export failed",t)}finally{this.exporting=!1,this.exportDialogOpen=!1}}}}),ne=fe("user",{state:()=>({id:null,user:null,loading:!1,error:null,hydrated:!1}),getters:{isAuthenticated:e=>!!e.user,userId:e=>{var t;return((t=e.user)==null?void 0:t.id)||""},displayName:e=>{var t,s;return((t=e.user)==null?void 0:t.full_name)||((s=e.user)==null?void 0:s.username)||""},role:e=>{var t;return((t=e.user)==null?void 0:t.role)||"guest"}},actions:{async hydrate(){if(!(this.hydrated||this.loading)){this.loading=!0;try{const{user:e}=await _a();this.user=e,this.error=null}catch(e){this.user=null,this.error=e}finally{this.hydrated=!0,this.loading=!1}}},async signIn({username:e,password:t}){this.loading=!0,this.error=null;try{const{user:s}=await wa({username:e,password:t});return this.user=s,this.hydrated=!0,this.user}catch(s){throw this.user=null,this.error=s,s}finally{this.loading=!1}},async signOut(){try{await ds()}finally{this.user=null,this.hydrated=!0,this.error=null}},clearAuth(){this.isAuthenticated=!1,this.user=null,this.token=null,localStorage.removeItem("auth_token")}}}),Vt=fe("dashboard",{state:()=>({workspaces:[],loading:!1,error:null,hydrated:!1}),getters:{hasWorkspaces:e=>e.workspaces.length>0,primaryWorkspaceName:e=>{var t;return(t=e.workspaces[0])!=null&&t.name?e.workspaces[0].name:"Workspace"}},actions:{async initialise(e={}){if(this.loading||this.hydrated&&!e.force)return;const s=ne().userId;this.loading=!0,this.error=null;try{const a=await Ga({query:{user_id:s,limit:30,sort:"-created_at"}}),o=(a==null?void 0:a.projects)||(a==null?void 0:a.workspaces)||[];this.workspaces=o.map(l=>({id:l.id,name:l.name||"Untitled workspace",createdAt:l.created_at,instructions:l.instructions||"No instructions provided."})),this.hydrated=!0}catch(a){console.error("Failed to load workspaces",a),this.error=a}finally{this.loading=!1}},async createWorkspace({name:e,instructions:t}={}){const s=typeof e=="string"?e.trim():"";if(!s)throw new Error("Workspace name is required.");const a={name:s,user_id:ne().userId};t&&t.trim()&&(a.instructions=t.trim());try{const o=await qa({payload:a}),l=(o==null?void 0:o.project)||(o==null?void 0:o.workspace)||o,n=l==null?void 0:l.id;if(await this.initialise({force:!0}),n){const d=this.workspaces.find(c=>c.id===n);return d||{id:n,name:(l==null?void 0:l.name)||s,createdAt:(l==null?void 0:l.created_at)||new Date().toISOString(),instructions:(l==null?void 0:l.instructions)||a.instructions||"No instructions provided."}}return null}catch(o){throw console.error("Failed to create workspace",o),o}},async updateWorkspace({id:e,name:t,instructions:s}={}){const a=typeof e=="string"?e.trim():"";if(!a)throw new Error("Workspace id is required.");const o={};if(typeof t=="string"&&t.trim()&&(o.name=t.trim()),s!==void 0&&(o.instructions=(s==null?void 0:s.trim())||""),Object.keys(o).length===0)throw new Error("No updates provided.");try{return await za({id:a,payload:o}),await this.initialise({force:!0}),this.workspaces.find(l=>l.id===a)||null}catch(l){throw console.error("Failed to update workspace",l),l}},async deleteWorkspace({id:e}={}){const t=typeof e=="string"?e.trim():"";if(!t)throw new Error("Workspace id is required.");try{await Wa({id:t}),await this.initialise({force:!0})}catch(s){throw console.error("Failed to delete workspace",s),s}}}}),ee=fe("workspaceContext",{state:()=>({workspaceId:"",workspaceName:""}),getters:{hasWorkspace:e=>!!e.workspaceId},actions:{setWorkspace({id:e,name:t}){e&&(this.workspaceId=e),t!==void 0&&(this.workspaceName=t)},resetWorkspace(){this.workspaceId="",this.workspaceName=""}}}),ft=()=>[""],Ya=fe("documents",{state:()=>({documents:[],loading:!1,error:null,menuOpen:!1,uploadDialogOpen:!1,linksDialogOpen:!1,uploadFiles:[],uploadInProgress:!1,linkEntries:ft(),linkSubmissionInProgress:!1}),getters:{hasDocuments:e=>e.documents.length>0,canSubmitLinks:e=>e.linkEntries.some(t=>t&&t.trim().length>0),canSubmitFiles:e=>e.uploadFiles.length>0},actions:{toggleMenu(e){this.menuOpen=typeof e=="boolean"?e:!this.menuOpen},openUploadDialog(){this.uploadFiles=[],this.uploadDialogOpen=!0,this.toggleMenu(!1)},closeUploadDialog(){this.uploadDialogOpen=!1,this.uploadFiles=[]},openLinksDialog(){this.linkEntries=ft(),this.linksDialogOpen=!0,this.toggleMenu(!1)},closeLinksDialog(){this.linksDialogOpen=!1,this.linkEntries=ft(),this.linkSubmissionInProgress=!1},addLinkField(){this.linkEntries=[...this.linkEntries,""]},removeLinkField(e){if(this.linkEntries.length===1){this.linkEntries=[""];return}this.linkEntries=this.linkEntries.filter((t,s)=>s!==e)},updateLinkField(e,t){this.linkEntries=this.linkEntries.map((s,a)=>a===e?t:s)},setUploadFiles(e){if(!e){this.uploadFiles=[];return}Array.isArray(e)?this.uploadFiles=e:e instanceof FileList?this.uploadFiles=Array.from(e):this.uploadFiles=[]},async fetchDocuments(){const e=ee();if(!e.hasWorkspace){this.documents=[];return}this.loading=!0,this.error=null;try{const t=await Ta({payload:{page:1,page_size:50,sort_field:"updated_at",sort_direction:"desc"},headers:{"X-Workspace":e.workspaceId}}),s=(t==null?void 0:t.documents)||[];this.documents=s.map(a=>({id:a.id,name:a.file_path||a.id,status:a.status,createdAt:a.created_at,updatedAt:a.updated_at,summary:a.content_summary}))}catch(t){console.error("Failed to fetch documents",t),this.error=t}finally{this.loading=!1}},async uploadSelectedFiles(){if(!this.canSubmitFiles||this.uploadInProgress)return;const e=ee();if(e.hasWorkspace){this.uploadInProgress=!0;try{const t=this.uploadFiles.map(s=>Aa({file:s,headers:{"X-Workspace":e.workspaceId}}));await Promise.all(t),this.closeUploadDialog(),await this.fetchDocuments()}catch(t){console.error("File upload failed",t),this.error=t}finally{this.uploadInProgress=!1}}},async submitLinks(){if(!this.canSubmitLinks||this.linkSubmissionInProgress)return;const e=ee();if(!e.hasWorkspace)return;const t=this.linkEntries.map(s=>s.trim()).filter(s=>s.length>0);if(t.length){this.linkSubmissionInProgress=!0;try{await Ia({payload:{links:t},headers:{"X-Workspace":e.workspaceId}}),this.closeLinksDialog(),await this.fetchDocuments()}catch(s){console.error("Link submission failed",s),this.error=s}finally{this.linkSubmissionInProgress=!1}}}}}),Za="edumind_ai_chat_history",ht=typeof globalThis!="undefined"?globalThis.crypto:void 0,et=e=>typeof e=="string"&&e.trim()?e.trim():"default",_s=e=>`${Za}:${et(e)}`,ws=()=>ht&&typeof ht.randomUUID=="function"?ht.randomUUID():`msg-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,er=new Set(["user","assistant","system"]),tr=e=>er.has(e)?e:"assistant",sr=e=>({id:`error-${Date.now()}-${e}`,role:"system",content:"Error loading message",isError:!0}),ar=(e,t)=>{try{if(!e||typeof e!="object")throw new Error("Invalid message payload");const s={id:typeof e.id=="string"&&e.id?e.id:ws(),role:tr(e.role),content:typeof e.content=="string"?e.content:""};return e.isError===!0&&(s.isError=!0),s}catch(s){return console.error("Failed to restore chat message from storage",s),sr(t)}},Gt=e=>{if(typeof window=="undefined"||!window.localStorage)return{messages:[],dirty:!1};try{const t=window.localStorage.getItem(_s(e));if(!t)return{messages:[],dirty:!1};const s=JSON.parse(t);if(!Array.isArray(s))return{messages:[],dirty:!1};let a=!1;return{messages:s.map((l,n)=>{const d=ar(l,n);if(!a){const c=l||{};a=d.id!==c.id||d.role!==c.role||d.content!==c.content||!!d.isError!=!!c.isError}return d}),dirty:a}}catch(t){return console.error("Failed to parse chat history from storage",t),{messages:[],dirty:!1}}},gt=(e,t)=>{if(!(typeof window=="undefined"||!window.localStorage))try{window.localStorage.setItem(_s(t),JSON.stringify(e))}catch(s){console.error("Failed to persist chat history",s)}},zt=(e,t="")=>({id:ws(),role:e,content:t}),rr=fe("chat",{state:()=>{const e=ne(),t=et(e.userId),{messages:s,dirty:a}=Gt(t);return a&&gt(s,t),{messages:s,historyUserId:t,inputValue:"",streaming:!1,error:null}},getters:{hasMessages:e=>e.messages.length>0,canSend:e=>e.inputValue.trim().length>0&&!e.streaming},actions:{setInput(e){this.inputValue=e},hydrateHistoryForCurrentUser(){const e=ne(),t=et(e.userId),{messages:s,dirty:a}=Gt(t);this.messages=s,this.historyUserId=t,a&&gt(this.messages,t)},persistHistory(){const e=this.historyUserId||"default";gt(this.messages,e)},clearConversation(){this.messages=[],this.error=null,this.persistHistory()},async sendMessage(){if(!this.canSend)return;const e=ee(),t=ne();if(et(t.userId)!==this.historyUserId&&this.hydrateHistoryForCurrentUser(),!e.hasWorkspace){this.error=new Error("Select a workspace before chatting.");return}const a=this.inputValue.trim();this.inputValue="",this.error=null;const o=this.messages.filter(d=>(d.role==="user"||d.role==="assistant")&&d.isError!==!0).slice(-10).map(d=>({role:d.role,content:d.content})),l=zt("user",a),n=zt("assistant","");this.messages=[...this.messages,l,n],this.streaming=!0,this.persistHistory();try{await Ra({payload:{query:a,mode:"mix",response_type:"Multiple Paragraphs",...o.length?{conversation_history:o}:{}},headers:{"X-Workspace":e.workspaceId},onChunk:d=>{n.content+=d,this.messages=[...this.messages],this.persistHistory()}})}catch(d){console.error("Streaming query failed",d),this.error=d,n.content=(d==null?void 0:d.message)||"Something went wrong.",n.isError=!0,this.messages=[...this.messages]}finally{this.streaming=!1,this.persistHistory()}}}}),or=fe("workspaceToolkit",{state:()=>({activeTab:"files"}),actions:{setActiveTab(e){this.activeTab=e}}});class ir{constructor(){this.nodes=[],this.edges=[],this.nodeIdMap={},this.edgeIdMap={},this.edgeDynamicIdMap={}}getNode(t){const s=this.nodeIdMap[t];return s!==void 0?this.nodes[s]:void 0}getEdge(t,s=!0){const a=s?this.edgeDynamicIdMap[t]:this.edgeIdMap[t];return a!==void 0?this.edges[a]:void 0}buildDynamicMap(){this.edgeDynamicIdMap={};for(let t=0;t<this.edges.length;t++){const s=this.edges[t];this.edgeDynamicIdMap[s.dynamicId]=t}}}const Et=fe("graph",{state:()=>({selectedNode:null,focusedNode:null,selectedEdge:null,focusedEdge:null,rawGraph:null,sigmaGraph:null,sigmaInstance:null,allDatabaseLabels:["*"],searchEngine:null,moveToSelectedNode:!1,isFetching:!1,graphIsEmpty:!1,lastSuccessfulQueryLabel:"",typeColorMap:new Map,graphDataFetchAttempted:!1,labelsFetchAttempted:!1,nodeToExpand:null,nodeToPrune:null,graphDataVersion:0}),getters:{hasGraph:e=>!!e.sigmaGraph&&e.sigmaGraph.order>0},actions:{setSigmaInstance(e){this.sigmaInstance=e},setSelectedNode(e,t=!1){this.selectedNode=e},setFocusedNode(e){this.focusedNode=e},setSelectedEdge(e){this.selectedEdge=e},setFocusedEdge(e){this.focusedEdge=e},setIsFetching(e){this.isFetching=!!e},setGraphIsEmpty(e){this.graphIsEmpty=!!e},setLastSuccessfulQueryLabel(e){this.lastSuccessfulQueryLabel=e||""},setRawGraph(e){this.rawGraph=e},setSigmaGraph(e){this.sigmaGraph=e||null},setAllDatabaseLabels(e){this.allDatabaseLabels=Array.isArray(e)?e:["*"]},setSearchEngine(e){this.searchEngine=e||null},resetSearchEngine(){this.searchEngine=null},setGraphDataFetchAttempted(e){this.graphDataFetchAttempted=!!e},setLabelsFetchAttempted(e){this.labelsFetchAttempted=!!e},setMoveToSelectedNode(e){this.moveToSelectedNode=!!e},setTypeColorMap(e){this.typeColorMap=e instanceof Map?e:new Map},clearSelection(){this.selectedNode=null,this.focusedNode=null,this.selectedEdge=null,this.focusedEdge=null},reset(){this.selectedNode=null,this.focusedNode=null,this.selectedEdge=null,this.focusedEdge=null,this.rawGraph=null,this.sigmaGraph=null,this.searchEngine=null,this.moveToSelectedNode=!1,this.graphIsEmpty=!1},incrementGraphDataVersion(){this.graphDataVersion=this.graphDataVersion+1},triggerNodeExpand(e){this.nodeToExpand=e},triggerNodePrune(e){this.nodeToPrune=e},async fetchAllDatabaseLabels(){try{const e={},s={"X-Workspace":ee().workspaceId},a=await Ha({query:e,headers:s});this.setAllDatabaseLabels(["*",...a||[]]),this.setLabelsFetchAttempted(!0)}catch(e){console.error("fetchAllDatabaseLabels failed:",e),this.setAllDatabaseLabels(["*"]),this.setLabelsFetchAttempted(!0)}},async fetchGraph(){this.setIsFetching(!0),this.setGraphDataFetchAttempted(!0);try{const e={label:"*",max_depth:6,max_nodes:1e3},s={"X-Workspace":ee().workspaceId},a=await Ba({query:e,headers:s}),{nodes:o,edges:l}=this._normalizeGraphResponse(a);console.log("nodes:",o,"edges:",l);const n=new ir;n.nodes=o||[],n.edges=l||[],n.nodeIdMap={};for(let c=0;c<n.nodes.length;c++)n.nodeIdMap[String(n.nodes[c].id)]=c;n.edgeIdMap={};for(let c=0;c<n.edges.length;c++)n.edgeIdMap[String(n.edges[c].id)]=c;n.buildDynamicMap();const d=new Gs({allowSelfLoops:!0});n.nodes.forEach(c=>{var y,k,x,T,_;const m={x:(y=c.x)!=null?y:Math.random()*10-5,y:(k=c.y)!=null?k:Math.random()*10-5,size:(x=c.size)!=null?x:4,color:(T=c.color)!=null?T:"#7aa2ff",label:((_=c.properties)==null?void 0:_.entity_id)||c.id,labels:c.labels||[],properties:c.properties||{}};d.addNode(String(c.id),m)}),n.edges.forEach(c=>{var _,A,P;const m=Number((A=(_=c.properties)==null?void 0:_.weight)!=null?A:1),y=Math.min(6,1+m*1.5),k={label:c.id,properties:c.properties||{},source:String(c.source),target:String(c.target),type:c.type||void 0,size:y},x=c.type==="DIRECTED"?"curvedArrow":"curvedNoArrow",T=(P=c.id)!=null?P:`${c.source}->${c.target}`;d.addEdgeWithKey(String(T),String(c.source),String(c.target),{...k,type:x})}),this.setRawGraph(n),this.setSigmaGraph(d),this.setGraphIsEmpty(d.order===0),this.incrementGraphDataVersion(),e&&e.label&&this.setLastSuccessfulQueryLabel(String(e.label))}catch(e){throw console.error("fetchGraph failed:",e),this.setSigmaGraph(null),this.setRawGraph(null),this.setGraphIsEmpty(!0),e}finally{this.setIsFetching(!1)}},_normalizeGraphResponse(e){return e?Array.isArray(e.nodes)&&Array.isArray(e.edges)?e:e.data&&Array.isArray(e.data.nodes)&&Array.isArray(e.data.edges)?e.data:{nodes:[],edges:[]}:{nodes:[],edges:[]}},async updateNodeAndSelect(e,t,s,a){const o=this.sigmaGraph,l=this.rawGraph;if(!(!o||!l||!o.hasNode(String(e))))try{const n=o.getNodeAttributes(String(e));if(e===t&&s==="entity_id"){const d=String(a);o.addNode(d,{...n,label:d});const c=[];o.forEachEdge(e,(y,k,x,T)=>{const _=x===e?T:x,A=x===e,P=k.dynamicId||y,N=l.edgeDynamicIdMap[P],S=o.addEdge(A?d:_,A?_:d,k);N!==void 0&&c.push({originalDynamicId:P,newEdgeId:S,edgeIndex:N}),o.dropEdge(y)}),o.dropNode(String(e));const m=l.nodeIdMap[String(e)];m!==void 0&&(l.nodes[m].id=d,l.nodes[m].labels=[d],l.nodes[m].properties.entity_id=d,delete l.nodeIdMap[String(e)],l.nodeIdMap[d]=m),c.forEach(({originalDynamicId:y,newEdgeId:k,edgeIndex:x})=>{const T=l.edges[x];T&&(T.source===e&&(T.source=d),T.target===e&&(T.target=d),T.dynamicId=k,delete l.edgeDynamicIdMap[y],l.edgeDynamicIdMap[k]=x)}),this.setSelectedNode(d,!0)}else{const d=l.nodeIdMap[String(e)];d!==void 0&&(l.nodes[d].properties[s]=a,s==="entity_id"&&(l.nodes[d].labels=[a],o.setNodeAttribute(String(e),"label",String(a)))),this.incrementGraphDataVersion()}}catch(n){throw console.error("updateNodeAndSelect error:",n),new Error("Failed to update node in graph")}},async updateEdgeAndSelect(e,t,s,a,o,l){const n=this.sigmaGraph,d=this.rawGraph;if(!(!n||!d))try{const c=d.edgeIdMap[String(e)];c!==void 0&&d.edges[c]&&(d.edges[c].properties[o]=l,t!==void 0&&o==="keywords"&&n.setEdgeAttribute(t,"label",String(l))),this.incrementGraphDataVersion(),this.setSelectedEdge(t)}catch(c){throw console.error(`updateEdgeAndSelect error for ${s}->${a}:`,c),new Error("Failed to update edge in graph")}},async loadGraph(){var e,t;graphStore.sigmaGraph||createRenderer(new Je),await graphStore.fetchAllDatabaseLabels();try{const s={"X-Workspace":ee().workspaceId};await graphStore.fetchGraph({query:{limit:1e3},headers:s}),console.log("order",(e=graphStore.sigmaGraph)==null?void 0:e.order,"edges",(t=graphStore.sigmaGraph)==null?void 0:t.size)}catch(s){console.error(s)}}}}),ks=e=>e[Math.floor(Math.random()*e.length)],nr=[{question:"Which data structure follows the First-In-First-Out (FIFO) principle?",options:["Stack","Queue","Tree","Graph"],correctOptions:[1],difficultyLevel:"medium",aiRational:"Queues process elements in the order they are inserted, making them ideal for task scheduling scenarios.",source:"Computer Science Fundamentals",tag:"Data Structures"},{question:"What is the capital city of Japan?",options:["Seoul","Tokyo","Kyoto","Osaka"],correctOptions:[1],difficultyLevel:"easy",aiRational:"Tokyo has been the political and economic center of Japan since 1868, making it the capital city.",source:"World Geography Reference",tag:"Geography"},{question:"Which law explains the relationship between voltage, current, and resistance?",options:["Faraday's Law","Newton's Law","Ohm's Law","Maxwell's Equation"],correctOptions:[2],difficultyLevel:"medium",aiRational:"Ohm's Law states that voltage equals current multiplied by resistance, forming the foundation of circuit analysis.",source:"Physics Core Concepts",tag:"Physics"}],lr=[{question:"Design a project brief for implementing a flipped classroom model in a high school setting.",difficultyLevel:"hard",aiRational:"This assignment evaluates strategic planning, curriculum design, and an understanding of pedagogical frameworks.",source:"Instructional Design Toolkit",tag:"Education"},{question:"Compose a reflection on how renewable energy adoption can transform urban infrastructures over the next decade.",difficultyLevel:"medium",aiRational:"Encourages learners to synthesize environmental science with socio-economic impacts for future-forward thinking.",source:"Sustainable Cities Program",tag:"Environmental Science"},{question:"Outline a user journey map for a mental wellness mobile application aimed at university students.",difficultyLevel:"medium",aiRational:"Focuses on empathy mapping, UX research, and translating insights into a product strategy.",source:"Digital Product Studio",tag:"Design Thinking"}],dr=[{question:"Create a five-question formative quiz that assesses understanding of the water cycle, including misconceptions.",difficultyLevel:"easy",aiRational:"Highlights the ability to scaffold learning checkpoints aligned with scientific literacy.",source:"Middle School Science Lab",tag:"Science"},{question:"Draft a collaborative workshop outline for onboarding new remote employees in a global organization.",difficultyLevel:"medium",aiRational:"Targets facilitation skills, asynchronous engagement, and inclusive team culture design.",source:"People Operations Playbook",tag:"People & Culture"}],cr=[{question:"Define neuroplasticity and provide an example of its role in learning resilience.",difficultyLevel:"medium",aiRational:"Reinforces conceptual clarity with practical application, suited for rapid revision.",source:"Cognitive Science Primer",tag:"Neuroscience"},{question:"Explain the purpose of Bloom's taxonomy in instructional design.",difficultyLevel:"easy",aiRational:"Supports quick recall of core pedagogical frameworks for lesson planning.",source:"Teaching Methodologies Handbook",tag:"Education"}],Wt=[{id:"mcq-generator",name:"MCQ Generator",description:"Create structured multiple-choice questions enriched with rationales.",icon:"mdi-help-box-multiple-outline",quickAction:"Generate MCQ"},{id:"distractor-generator",name:"Distractor Generator",description:"Generate alternate distractors for an existing MCQ question.",icon:"mdi-arrange-bring-forward",quickAction:"Generate Distractors",is_new:!0},{id:"graph-visualizer",name:"Knowledge Graph Visualizer",description:"Visualize and explore relationships between concepts using an interactive graph.",icon:"mdi-graph-outline",quickAction:"Visualize Graph",is_new:!0},{id:"notes-maker",name:"Notes Maker",description:"Create and export (PDF / PPT) notes with AI-powered insights.",icon:"mdi-note-text-outline",quickAction:"Create Notes",is_new:!0}],Ss=()=>`output-${Math.random().toString(36).slice(2,10)}`,ur=()=>`viewer-${Math.random().toString(36).slice(2,10)}`,Qt=(e,t=0)=>{var s,a,o,l;return{id:(s=e==null?void 0:e.id)!=null?s:ur(),name:((a=e==null?void 0:e.name)==null?void 0:a.trim())||`Viewer ${t+1}`,meta:(o=e==null?void 0:e.meta)!=null?o:null,isViewer:(l=e==null?void 0:e.isViewer)!=null?l:!0}},yt=()=>{const e=ks(nr);return{id:Ss(),type:"mcq",...e}},vt=(e=lr)=>{const t=ks(e);return{id:Ss(),type:"assignment",options:[],correctOptions:[],...t}},xs=(e="")=>{const t=/canvas\s+(\d+)$/i.exec(e.trim());if(!t)return null;const s=Number(t[1]);return Number.isNaN(s)?null:s},Rt=(e=[])=>e.reduce((t,s)=>{const a=xs(s.name);return a?Math.max(t,a):t},0),ze=e=>e?{"X-Workspace":e}:{},jt=(e,t)=>({id:(e==null?void 0:e.id)||"",name:(e==null?void 0:e.name)||(e==null?void 0:e.topic)||`Canvas ${t+1}`,outputs:[],meta:e||null}),Cs=e=>Array.isArray(e)?e:e&&typeof e=="object"?Object.values(e):typeof e=="string"?[e]:[],pr=e=>Cs(e).map(t=>String(t)),As=(e,t)=>{const s=Array.isArray(e)?e:e&&typeof e=="object"?Array.isArray(e.indices)?e.indices:Object.values(e):[],a=new Set;return s.forEach(o=>{const l=Number(o);Number.isInteger(l)&&l>=0&&(t===void 0||l<t)&&a.add(l)}),Array.from(a)},mr=e=>Array.isArray(e)?e.map(t=>{if(!t)return null;const s=Array.isArray(t.options)?t.options.map(l=>String(l)):[],a=t.correct_answers||t.correctIndexes||t.correct_indexes,o=As(a,s.length);return{id:t.id||null,difficulty_level:t.difficulty_level||t.difficultyLevel||null,options:s,correct_answers:o,rationale:t.rationale||t.ai_rational||""}}).filter(t=>t!==null):[],fr=e=>{if(!e)return null;const t=pr(e.options),s=As(e.correct_answers,t.length),a=Cs(e.tags);return{id:e.id||`question-${Math.random().toString(36).slice(2,10)}`,type:e.type||"mcq",question:e.question_text||"Generated question",options:t,correctOptions:s,difficultyLevel:e.difficulty_level||"medium",aiRational:e.ai_rational||e.rationale||"Generated by AI.",source:e.source||"AI Generator",tag:a.length?a.join(", "):"AI Generated",variants:Array.isArray(e.variants)?e.variants:[],meta:e,questionId:e.id}},Ue=fe("home",{state:()=>({tools:Wt,expandedToolIds:Wt.slice(0,0).map(e=>e.id),tabs:[],viewerTabs:[],activeTabId:"",tabCounter:0,viewerTabCounter:0,loading:!1,error:null,creatingCanvas:!1,deletingCanvasIds:[],currentProjectId:"",canvasOutputStatus:{}}),getters:{activeTab(e){return!e.activeTabId&&e.tabs.length?e.tabs[0]:e.tabs.find(t=>t.id===e.activeTabId)||null},activeTabOutputs(){return this.activeTab?this.activeTab.outputs:[]},hasActiveOutputs(){return this.activeTabOutputs.length>0},canAddTab(){return Oe(),this.tabs.length<2},canAddViewerTab(){return Oe(),this.viewerTabs.length<1},viewerTabCount(e){return e.viewerTabs.length},isDeletingCanvas:e=>t=>e.deletingCanvasIds.includes(t),isCanvasLoading:e=>t=>{var s;return!!((s=e.canvasOutputStatus[t])!=null&&s.loading)},hasHydratedCanvas:e=>t=>{var s;return!!((s=e.canvasOutputStatus[t])!=null&&s.loaded)}},actions:{initialise(){!this.activeTabId&&this.tabs.length&&(this.activeTabId=this.tabs[0].id)},setExpandedToolIds(e){this.expandedToolIds=Array.from(new Set(e))},toggleTool(e){this.expandedToolIds.includes(e)?this.expandedToolIds=this.expandedToolIds.filter(t=>t!==e):this.expandedToolIds=[...this.expandedToolIds,e]},setActiveTab(e){if(this.activeTabId=e,!e)return;this.tabs.some(s=>s.id===e)&&this.loadCanvasOutputs({tabId:e}).catch(()=>{})},updateCanvasOutputStatus(e,t={}){if(!e)return;const s={...this.canvasOutputStatus},a=s[e]||{};s[e]={...a,...t},this.canvasOutputStatus=s},applyOutputsToTab(e,t=[]){if(!e)return;const s=this.tabs.find(a=>a.id===e);s&&(s.outputs=t)},setCanvasCollection(e=[]){const t=e.map((l,n)=>jt(l,n));this.tabs=t,this.tabCounter=Rt(t);const s={};if(t.forEach(l=>{this.canvasOutputStatus[l.id]&&(s[l.id]=this.canvasOutputStatus[l.id])}),this.canvasOutputStatus=s,!t.length){this.activeTabId="";return}const a=t.find(l=>l.id===this.activeTabId),o=a?a.id:t[0].id;if(!o){this.activeTabId="";return}this.activeTabId===o?this.loadCanvasOutputs({tabId:o}).catch(()=>{}):this.setActiveTab(o)},async loadCanvasOutputs({tabId:e,force:t=!1}={}){var n;const a=ee().workspaceId||this.currentProjectId,o=e||this.activeTabId;if(!o)return;const l=this.canvasOutputStatus[o];if(t){if(l!=null&&l.loading)return}else if(l!=null&&l.loading||l!=null&&l.loaded)return;this.updateCanvasOutputStatus(o,{loading:!0,loaded:!1,error:null});try{const d=await ps({query:{session_id:o,project_id:a,isArchived:!1,page:1,pageSize:50,sort:"updated_at",order:"desc"},headers:ze(a)}),m=(Array.isArray(d==null?void 0:d.questions)?d.questions:Array.isArray((n=d==null?void 0:d.data)==null?void 0:n.questions)?d.data.questions:[]).map(x=>fr(x)).filter(x=>x!==null),y=this.tabs.find(x=>x.id===o);if(Array.isArray(y==null?void 0:y.outputs)&&y.outputs.length>0&&m.length===0&&!t){this.updateCanvasOutputStatus(o,{loading:!1,loaded:!0,error:null});return}this.applyOutputsToTab(o,m),this.updateCanvasOutputStatus(o,{loading:!1,loaded:!0,error:null})}catch(d){throw console.error("Failed to load canvas outputs",d),this.error=d,this.updateCanvasOutputStatus(o,{loading:!1,loaded:!1,error:d}),d}},applyVariantsToQuestion(e,t){if(!e)return!1;const s=mr(t);let a=!1;return this.tabs=this.tabs.map(o=>{const l=o.outputs.map(n=>n&&(n.id===e||n.questionId===e?(a=!0,{...n,variants:s,meta:{...n.meta||{},variants:s}}):n));return{...o,outputs:l}}),a},async loadProjectCanvases({projectId:e,force:t=!1}={}){if(this.loading)return;const s=ee(),a=ne(),o=Oe(),l=e||s.workspaceId;if(!l){this.currentProjectId="",this.setCanvasCollection([]);return}if(!(!t&&this.currentProjectId===l&&this.tabs.length)){this.loading=!0,this.error=null,this.currentProjectId=l;try{const n=await La({projectId:l,userId:a.userId,limit:o.maxCanvasTabs,headers:ze(l)}),d=Array.isArray(n==null?void 0:n.canvases)?n.canvases:[];this.setCanvasCollection(d)}catch(n){console.error("Failed to load canvases",n),this.error=n,this.setCanvasCollection([])}finally{this.loading=!1}}},async ensureActiveCanvas(){if(this.activeTab)return this.activeTab;if(this.currentProjectId&&(await this.loadProjectCanvases({projectId:this.currentProjectId,force:!0}),this.activeTab))return this.activeTab;if(!this.canAddTab)return null;try{return await this.addTab()}catch(e){return console.error("Failed to ensure active canvas",e),null}},async addTab({name:e}={}){if(!this.canAddTab)return!1;const t=ee(),s=ne(),a=t.workspaceId||this.currentProjectId;if(!a)return this.error=new Error("Select a project before creating a canvas."),!1;const o=ze(a),l=typeof e=="string"?e.trim():"",n=this.tabCounter+1,d=l||`Canvas ${n}`;this.creatingCanvas=!0,this.error=null;try{const c=await Pa({payload:{user_id:s.userId,project_id:a,topic:d},headers:o}),m=c==null?void 0:c.session_id;if(!m)throw new Error("The server did not return a session identifier.");let y=null;try{const T=await Ua({id:m,headers:o});y=(T==null?void 0:T.canvas)||null}catch(T){console.warn("Failed to fetch canvas metadata",T)}const k=jt(y||{id:m,name:d,topic:d,userId:s.userId,projectId:a},this.tabs.length);k.id=m;const x=xs(k.name)||n;return this.tabCounter=Math.max(this.tabCounter,x),this.tabs=[...this.tabs,k],this.currentProjectId=a,this.setActiveTab(k.id),k}catch(c){throw console.error("Failed to create canvas",c),this.error=c,c}finally{this.creatingCanvas=!1}},async closeTab(e){var l;if(!e||!this.tabs.find(n=>n.id===e))return!1;const a=ee().workspaceId||this.currentProjectId,o=ze(a);this.deletingCanvasIds=Array.from(new Set([...this.deletingCanvasIds,e])),this.error=null;try{await Oa({id:e,headers:o}),this.tabs=this.tabs.filter(d=>d.id!==e);const n={...this.canvasOutputStatus};if(delete n[e],this.canvasOutputStatus=n,this.activeTabId===e){const d=((l=this.tabs[0])==null?void 0:l.id)||"";d?this.setActiveTab(d):this.activeTabId=""}return this.tabCounter=Rt(this.tabs),!0}catch(n){throw console.error("Failed to delete canvas",n),this.error=n,n}finally{this.deletingCanvasIds=this.deletingCanvasIds.filter(n=>n!==e)}},discardActiveTabOutputs(){this.activeTab&&(this.activeTab.outputs=[])},async deleteOutputById(e){var n;const t=this.activeTab;if(!t)return;const s=t.outputs.find(d=>d.id===e);if(!s)return;const a=s.questionId||((n=s.meta)==null?void 0:n.id);if(t.outputs=t.outputs.filter(d=>d.id!==e),!a)return;const l=ee().workspaceId||this.currentProjectId;try{await Va({id:a,headers:ze(l)})}catch(d){console.error("Failed to delete question",d),this.error=d}},resetWorkspace(){this.setCanvasCollection([]),this.currentProjectId="",this.tabCounter=0},async appendOutputs(e){if(!Array.isArray(e)||e.length===0)return;const t=await this.ensureActiveCanvas();if(!t)throw new Error("No canvas available to accept generated outputs.");t.outputs=[...t.outputs,...e],this.updateCanvasOutputStatus(t.id,{loaded:!0,loading:!1,error:null})},async executeTool(e){try{const t=await this.ensureActiveCanvas();if(!t)return null;const o=({"mcq-generator":()=>yt(),"assignment-generator":()=>vt(),"quiz-builder":()=>Math.random()>.5?yt():vt(dr),"flashcard-creator":()=>vt(cr)}[e]||(()=>yt()))();return t.outputs=[...t.outputs,o],o}catch(t){return console.error("Failed to execute tool",t),this.error=t,null}},setViewerTabs(e=[]){const t=e.map((s,a)=>Qt(s,a));this.viewerTabs=t,this.viewerTabCounter=t.length},createViewerTab(e={}){if(!this.canAddViewerTab)return null;const t=this.viewerTabCounter+1,s=Qt({name:e.name,meta:e.meta,id:e.id,isViewer:!0},t-1);return this.viewerTabs.some(a=>a.id===s.id)?null:(this.viewerTabs=[...this.viewerTabs,s],this.viewerTabCounter=this.viewerTabs.length,s)},removeViewerTab(e){return!e||!this.viewerTabs.some(s=>s.id===e)?!1:(this.viewerTabs=this.viewerTabs.filter(s=>s.id!==e),this.viewerTabCounter=this.viewerTabs.length,!0)},async loadGraph(){const e=Et();await e.fetchAllDatabaseLabels();const t={"X-Workspace":ee().workspaceId};await e.fetchGraph({query:{limit:1e3},headers:t})},async handleVisualizeGraph(){try{const e=this.createViewerTab({name:`Viewer ${this.viewerTabCounter+1}`,meta:{},isViewer:!0});this.setActiveTab(e.id),await this.loadGraph()}catch(e){return console.error("Failed to visualize graph",e),this.error=e,null}}}}),hr=()=>({topics:"",quantity:5,difficulty:"medium",allowMulti:!1,onlyTF:!1,userInstructions:"",userNotes:"",sessionId:"",projectId:"",userId:"",maxConcurrency:5,loading:!1,error:null,lastMessage:"",advancedOpen:!1}),gr=(e,t)=>{if(!Array.isArray(t))return[];const s=t.map(a=>{const o=Number(a);return Number.isNaN(o)?null:e&&e.length&&o>=e.length&&o-1>=0?o-1:o}).filter(a=>a!==null);return[...new Set(s)].filter(a=>a>=0&&a<e.length)},yr=(e,t)=>{const s=Array.isArray(e==null?void 0:e.options)?e.options:[],a=gr(s,(e==null?void 0:e.correct_answers)||(e==null?void 0:e.correctOptions)),o=Array.isArray(e==null?void 0:e.tags)?e.tags.join(", "):(e==null?void 0:e.tag)||"AI Generated";return{id:`ai-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:"mcq",question:(e==null?void 0:e.question_text)||(e==null?void 0:e.question)||"Generated question",options:s,correctOptions:a,difficultyLevel:(e==null?void 0:e.difficulty_level)||t,aiRational:(e==null?void 0:e.ai_rational)||(e==null?void 0:e.rationale)||"",source:(e==null?void 0:e.source)||"AI Generator",tag:o}},vr=fe("mcqGenerator",{state:hr,getters:{canGenerate(e){return e.topics.trim().length>0&&!e.loading}},actions:{initialise(){const e=ne();this.userId||(this.userId=e.userId)},toggleAdvanced(e){this.advancedOpen=typeof e=="boolean"?e:!this.advancedOpen},resetStatus(){this.error=null,this.lastMessage=""},async generate(){if(!this.canGenerate)return;const e=ee();if(!e.hasWorkspace){this.error=new Error("Select a workspace before generating questions.");return}const t=ne(),s=Ue(),a=await s.ensureActiveCanvas();if(!a){this.error=new Error("Create a canvas before generating questions.");return}const o=a.id||s.activeTabId||"default";this.sessionId=o;const l={session_id:o,project_id:this.projectId||e.workspaceId,user_id:this.userId||t.userId,topics:this.topics,n:this.quantity,difficulty:this.difficulty,user_instructions:this.userInstructions,user_notes:this.userNotes,max_concurrency:this.maxConcurrency,allow_multi:this.allowMulti,only_tf:this.onlyTF};this.loading=!0,this.error=null,this.lastMessage="";try{const n=await $a({payload:l,headers:{"X-Workspace":e.workspaceId}}),d=Array.isArray(n==null?void 0:n.questions)?n.questions:[];if(!d.length){this.error=new Error("The generator returned no questions. Try different topics or settings.");return}const c=d.map(m=>yr(m,this.difficulty));if(!c.length){this.error=new Error("Unable to interpret the generated questions.");return}await s.appendOutputs(c);try{await s.loadCanvasOutputs({tabId:o,force:!0})}catch(m){console.warn("Failed to refresh canvas questions",m)}this.lastMessage=(n==null?void 0:n.message)||`Generated ${c.length} questions.`}catch(n){console.error("Failed to generate questions",n),this.error=n}finally{this.loading=!1}}}}),ct=fe("header",{state:()=>({title:"",description:"",showBack:!1,actions:[]}),actions:{setHeader({title:e="",description:t="",showBack:s=!1,actions:a=[]}={}){this.title=e,this.description=t,this.showBack=s,this.actions=Array.isArray(a)?a:[]},resetHeader(){this.title="",this.description="",this.showBack=!1,this.actions=[]}}}),Bt=()=>({questionId:"",selectedQuestionText:"",selectionActive:!1,instructions:"",loading:!1,error:null,lastMessage:""}),Is=fe("distractorGenerator",{state:Bt,actions:{setQuestionId(e){const t=typeof e=="string"?e:"",s=this.questionId;this.questionId=t,t!==s&&(this.selectedQuestionText="")},setInstructions(e){this.instructions=e},beginSelection(){this.selectionActive=!0,this.error=null},completeSelection({id:e,text:t}){e&&(this.questionId=e,this.selectedQuestionText=t||"",this.selectionActive=!1,this.error=null)},cancelSelection(){this.selectionActive=!1},clearSelection(){this.questionId="",this.selectedQuestionText="",this.selectionActive=!1},reset(){Object.assign(this,Bt())},async generate(){const e=this.questionId.trim();if(!e){this.error=new Error("Enter a question ID first.");return}const t=ne(),s=ee(),a=Ue();this.loading=!0,this.error=null,this.lastMessage="",this.selectionActive=!1;try{const o=await Fa({questionId:e,payload:{user_id:t.userId,instructions:this.instructions.trim()||void 0,persist:!0},headers:s.workspaceId?{"X-Workspace":s.workspaceId}:void 0}),l=Array.isArray(o==null?void 0:o.variants)?o.variants:[];if(!a.applyVariantsToQuestion(e,l)){this.error=new Error("Unable to find that question on the current canvas.");return}this.lastMessage=(o==null?void 0:o.message)||`Generated ${l.length} variant sets.`}catch(o){console.error("Failed to generate distractors",o),this.error=o}finally{this.loading=!1}}}}),Ht=()=>({requirements:"",includePdf:!0,includePpt:!0,outputDir:"./output",loading:!1,error:null,lastMessage:"",generatedFiles:[],downloadUrls:[],topicsCovered:[],agentTraceId:null}),br=fe("notesMaker",{state:Ht,getters:{canGenerate(e){return e.requirements.trim().length>0&&!e.loading&&(e.includePdf||e.includePpt)},hasGeneratedFiles(e){return e.generatedFiles.length>0}},actions:{setRequirements(e){this.requirements=e,this.resetStatus()},setIncludePdf(e){this.includePdf=e,this.resetStatus()},setIncludePpt(e){this.includePpt=e,this.resetStatus()},setOutputDir(e){this.outputDir=e,this.resetStatus()},resetStatus(){this.error=null,this.lastMessage=""},reset(){Object.assign(this,Ht())},async generate(){if(!this.canGenerate)return;const e=ee();if(!e.hasWorkspace){this.error=new Error("Please select a workspace before generating notes.");return}const t=ne();this.loading=!0,this.error=null,this.lastMessage="",this.generatedFiles=[],this.downloadUrls=[],this.topicsCovered=[],this.agentTraceId=null;try{const s={requirements:this.requirements,include_pdf:this.includePdf,include_ppt:this.includePpt,output_dir:this.outputDir},a={"X-Workspace":e.workspaceId,"X-User-ID":t.userId},o=await Da({payload:s,headers:a});if(o.status==="success"||o.status==="completed")this.generatedFiles=o.generated_files||[],this.downloadUrls=o.download_urls||[],this.topicsCovered=o.topics_covered||[],this.agentTraceId=o.agent_trace_id,this.lastMessage=o.message||"Content generated successfully!",this.downloadUrls.length>0&&await this.downloadGeneratedFiles();else if(o.status==="partial")this.generatedFiles=o.generated_files||[],this.downloadUrls=o.download_urls||[],this.topicsCovered=o.topics_covered||[],this.agentTraceId=o.agent_trace_id,this.lastMessage=o.message||"Content partially generated.",this.error=new Error("Some files may not have been generated correctly"),this.downloadUrls.length>0&&await this.downloadGeneratedFiles();else throw new Error(o.error||o.message||"Failed to generate content")}catch(s){console.error("Error generating notes:",s),this.error=s,this.lastMessage=s.message||"Failed to generate content"}finally{this.loading=!1}},async downloadGeneratedFiles(){if(!(!this.downloadUrls||this.downloadUrls.length===0)){ee(),ne();try{for(const e of this.downloadUrls){const t=e.split("/").pop(),s=document.createElement("a");s.href=`${window.location.origin}${e}`,s.download=t,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),await new Promise(a=>setTimeout(a,500))}this.lastMessage=`Downloaded ${this.downloadUrls.length} file(s) successfully!`}catch(e){console.error("Error downloading files:",e),this.error||(this.error=e),this.lastMessage="Files generated but download failed. Please try downloading from the output directory."}}},async checkAgentStatus(){try{return await Na()}catch(e){return console.error("Error checking agent status:",e),{status:"error",message:e.message}}}}}),_r={class:"app-page-header__bar"},wr={class:"app-page-header__brand"},kr={class:"app-page-header__brand-initials text-subtitle-1 font-weight-semibold"},Sr={class:"text-overline text-uppercase text-medium-emphasis mb-1"},xr={class:"text-h5 font-weight-semibold mb-0"},Cr={key:0,class:"app-page-header__actions"},Ar={key:0,class:"text-body-2 text-medium-emphasis mb-0"},Ir={class:"app-page-header__action-buttons"},Tr=ge({__name:"AppPageHeader",props:{title:{default:""},description:{default:""},showBack:{type:Boolean,default:!1},actions:{default:()=>[]}},setup(e){const t=e,s=wt(),a=Oe(),o=ne(),l=$(()=>a.organization),n=$(()=>a.organizationInitials),d=$(()=>{var x;return(x=t.actions)!=null?x:[]}),c=$(()=>!!t.description||t.showBack||d.value.length>0),m=()=>{s.back()},y=x=>{typeof x.onClick=="function"&&x.onClick()},k=async()=>{try{await ds()}catch(x){console.error(x)}finally{o.clearAuth(),await _t(),await s.push({name:"Login"})}};return(x,T)=>{const _=Kt("RouterLink");return g(),W(Js,{flat:"",color:"white",class:"app-page-header",height:"76"},{default:i(()=>[r(ot,{class:"py-0",fluid:""},{default:i(()=>[p("div",_r,[p("div",wr,[r(_,{class:"app-page-header__brand-link",to:{name:"Dashboard"},"aria-label":"Go to dashboard",title:"Go to dashboard"},{default:i(()=>[r(we,{color:"primary",size:"48",variant:"flat"},{default:i(()=>[p("span",kr,O(n.value),1)]),_:1}),p("div",null,[p("p",Sr,O(l.value),1),p("h1",xr,O(e.title),1)])]),_:1})]),c.value?(g(),V("div",Cr,[e.description?(g(),V("p",Ar,O(e.description),1)):X("",!0),p("div",Ir,[e.showBack?(g(),W(G,{key:0,variant:"text",color:"primary","prepend-icon":"mdi-arrow-left",onClick:m},{default:i(()=>[...T[0]||(T[0]=[b(" Go Back ",-1)])]),_:1})):X("",!0),(g(!0),V(Z,null,re(d.value,A=>(g(),W(G,{key:A.id,variant:A.variant||"flat",color:A.color||"primary",class:"px-6","prepend-icon":A.icon,to:A.to,disabled:A.disabled,loading:A.loading,onClick:P=>y(A)},{default:i(()=>[b(O(A.label),1)]),_:2},1032,["variant","color","prepend-icon","to","disabled","loading","onClick"]))),128))])])):X("",!0)])]),_:1}),h(o).isAuthenticated?(g(),W(G,{key:0,variant:"flat",style:{margin:"16px"},"prepend-icon":"mdi-logout",color:"red",onClick:k},{default:i(()=>[...T[1]||(T[1]=[b(" Logout ",-1)])]),_:1})):X("",!0)]),_:1})}}}),he=(e,t)=>{const s=e.__vccOpts||e;for(const[a,o]of t)s[a]=o;return s},Vr=he(Tr,[["__scopeId","data-v-01c84cfe"]]),Er=ge({__name:"App",setup(e){const t=kt(),s=Oe(),a=ct(),{title:o,description:l,showBack:n,actions:d}=oe(a),c=$(()=>o.value||s.appName),m=$(()=>l.value||""),y=$(()=>n.value),k=$(()=>d.value||[]);return se(()=>t.name,()=>{o.value||a.setHeader({title:s.appName})},{immediate:!0}),(x,T)=>{const _=Kt("router-view");return g(),W(Ys,null,{default:i(()=>[r(Vr,{title:c.value,description:m.value,"show-back":y.value,actions:k.value},null,8,["title","description","show-back","actions"]),r(Zs,{class:"app-main"},{default:i(()=>[r(_)]),_:1})]),_:1})}}}),$r=he(Er,[["__scopeId","data-v-9200b5f6"]]),Fr={class:"dashboard-page"},Dr={class:"dashboard-page__intro"},Nr={class:"dashboard-page__actions-toolbar"},Pr={key:0,class:"dashboard-page__state"},Mr={key:1,class:"dashboard-page__state"},Or={class:"dashboard-page__card-header"},Lr={class:"dashboard-page__card-meta"},Ur={class:"dashboard-page__card-meta-top"},qr={class:"text-subtitle-1 font-weight-semibold mb-1"},Gr={class:"text-caption text-medium-emphasis mb-0"},zr={class:"text-body-2 text-medium-emphasis mb-0"},Wr={key:3,class:"dashboard-page__state"},Qr={class:"text-body-2 mb-0"},Rr=ge({__name:"DashboardPage",setup(e){const t=Vt(),s=wt(),a=ct(),{workspaces:o,loading:l,error:n,hasWorkspaces:d}=oe(t),c=Y(!1),m=Y("create"),y=Y(""),k=Y(!1),x=Y(""),T=Y(""),_=Y(""),A=Y(!1),P=Y(!1),N=Y(null),S=$(()=>m.value==="edit"),D=$(()=>S.value?"Edit Workspace":"Create Workspace"),q=()=>{t.initialise({force:!0})},L=z=>{if(!z)return"recently";const C=new Date(z);return Number.isNaN(C.getTime())?"recently":C.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},F=()=>{x.value="",T.value="",_.value="",y.value="",m.value="create"},u=()=>{F(),m.value="create",c.value=!0},f=z=>{F(),m.value="edit",y.value=z.id,x.value=z.name,T.value=z.instructions==="No instructions provided."?"":z.instructions,c.value=!0},v=()=>{c.value=!1,F()},I=async()=>{if(!x.value.trim()){_.value="Workspace name is required.";return}k.value=!0,_.value="";try{let z;S.value?z=await t.updateWorkspace({id:y.value,name:x.value,instructions:T.value}):z=await t.createWorkspace({name:x.value,instructions:T.value}),v(),z!=null&&z.id&&s.push({name:"Studio",query:{workspaceId:z.id}})}catch(z){_.value=(z==null?void 0:z.message)||`Failed to ${S.value?"update":"create"} workspace.`}finally{k.value=!1}},M=z=>{N.value={id:z.id,name:z.name},A.value=!0,_.value=""},H=()=>{A.value=!1,N.value=null,_.value=""},J=async()=>{var z;if((z=N.value)!=null&&z.id){P.value=!0,_.value="";try{await t.deleteWorkspace({id:N.value.id}),H()}catch(C){_.value=(C==null?void 0:C.message)||"Failed to delete workspace."}finally{P.value=!1}}},K=()=>{a.setHeader({title:"Workspace Dashboard",description:"Curate your knowledge spaces and continue building content.",actions:[{id:"go-questions",label:"Go to Questions Library",icon:"mdi-file-document-multiple-outline",variant:"text",to:{name:"Questions"}}]})};return Ae(()=>{t.initialise(),K()}),Jt(()=>{K()}),Yt(()=>{a.resetHeader()}),tt(()=>{a.resetHeader()}),se([l,k,P],()=>{K()}),(z,C)=>(g(),V("div",Fr,[r(ot,{fluid:"",class:"dashboard-page__content"},{default:i(()=>[p("div",Dr,[C[6]||(C[6]=p("div",null,[p("h2",{class:"text-subtitle-1 font-weight-semibold mb-1"},"Curate your knowledge spaces")],-1)),p("div",Nr,[r(G,{color:"primary",variant:"flat","prepend-icon":"mdi-plus-circle-outline",disabled:h(l)||k.value,onClick:u},{default:i(()=>[...C[4]||(C[4]=[b(" Create Workspace ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:h(l),onClick:q},{default:i(()=>[...C[5]||(C[5]=[b(" Refresh ",-1)])]),_:1},8,["loading"])])]),h(l)?(g(),V("div",Pr,[r(Be,{indeterminate:"",color:"primary",size:"40"}),C[7]||(C[7]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-0"},"Loading workspaces",-1))])):h(n)?(g(),V("div",Mr,[r(pe,{size:"36",color:"primary"},{default:i(()=>[...C[8]||(C[8]=[b("mdi-alert-circle-outline",-1)])]),_:1}),C[10]||(C[10]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-2"},"Unable to load workspaces.",-1)),r(G,{color:"primary",variant:"flat",onClick:q},{default:i(()=>[...C[9]||(C[9]=[b("Try Again",-1)])]),_:1})])):(g(),W(st,{key:2,class:"dashboard-page__grid",align:"stretch",justify:"start"},{default:i(()=>[(g(!0),V(Z,null,re(h(o),j=>(g(),W(ce,{key:j.id,cols:"12",sm:"6",md:"4",class:"dashboard-page__grid-item"},{default:i(()=>[r(ie,{class:"dashboard-page__card",elevation:"2"},{default:i(()=>[r(je,{class:"pb-2"},{default:i(()=>[p("div",Or,[r(we,{color:"primary",size:"40",variant:"flat"},{default:i(()=>[r(pe,{size:"20",color:"white"},{default:i(()=>[...C[11]||(C[11]=[b("mdi-folder-outline",-1)])]),_:1})]),_:1}),p("div",Lr,[p("div",Ur,[p("h3",qr,O(j.name),1),r(ts,{location:"bottom end"},{activator:i(({props:ae})=>[r(G,Zt({icon:"",variant:"text",color:"primary"},{ref_for:!0},ae),{default:i(()=>[r(pe,null,{default:i(()=>[...C[12]||(C[12]=[b("mdi-dots-vertical",-1)])]),_:1})]),_:1},16)]),default:i(()=>[r(Ee,{density:"comfortable"},{default:i(()=>[r(le,{onClick:ae=>f(j)},{default:i(()=>[r(Qe,null,{default:i(()=>[...C[13]||(C[13]=[b("Edit workspace",-1)])]),_:1})]),_:1},8,["onClick"]),r(le,{onClick:ae=>M(j)},{default:i(()=>[r(Qe,null,{default:i(()=>[...C[14]||(C[14]=[b("Delete workspace",-1)])]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024)]),p("p",Gr," Created "+O(L(j.createdAt)),1)])])]),_:2},1024),r(me,{class:"dashboard-page__card-text"},{default:i(()=>[p("p",zr,O(j.instructions),1)]),_:2},1024),r(De,{class:"pt-0"},{default:i(()=>[r(G,{variant:"text",color:"primary","prepend-icon":"mdi-launch",to:{name:"Studio",query:{workspaceId:j.id}}},{default:i(()=>[...C[15]||(C[15]=[b(" Open Workspace ",-1)])]),_:1},8,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})),!h(l)&&!h(d)&&!h(n)?(g(),V("div",Wr,[r(pe,{size:"36",color:"primary"},{default:i(()=>[...C[16]||(C[16]=[b("mdi-folder-remove-outline",-1)])]),_:1}),C[17]||(C[17]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-0"}," No workspaces have been created for this user yet. ",-1))])):X("",!0)]),_:1}),r(Re,{modelValue:c.value,"onUpdate:modelValue":C[2]||(C[2]=j=>c.value=j),"max-width":"480"},{default:i(()=>[r(ie,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[b(O(D.value),1)]),_:1}),r(me,{class:"pt-4"},{default:i(()=>[r(_e,{modelValue:x.value,"onUpdate:modelValue":C[0]||(C[0]=j=>x.value=j),label:"Workspace name",variant:"outlined",density:"comfortable",disabled:k.value,required:""},null,8,["modelValue","disabled"]),r(Le,{modelValue:T.value,"onUpdate:modelValue":C[1]||(C[1]=j=>T.value=j),label:"Instructions (optional)",variant:"outlined",density:"comfortable","auto-grow":"",rows:"3",disabled:k.value},null,8,["modelValue","disabled"]),_.value?(g(),W(be,{key:0,type:"error",variant:"tonal",density:"comfortable",class:"mt-3"},{default:i(()=>[b(O(_.value),1)]),_:1})):X("",!0)]),_:1}),r(De,{class:"justify-end"},{default:i(()=>[r(G,{variant:"text",color:"primary",onClick:v,disabled:k.value},{default:i(()=>[...C[18]||(C[18]=[b(" Cancel ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"flat",loading:k.value,onClick:I},{default:i(()=>[b(O(S.value?"Save Changes":"Create"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(Re,{modelValue:A.value,"onUpdate:modelValue":C[3]||(C[3]=j=>A.value=j),"max-width":"420"},{default:i(()=>[r(ie,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[...C[19]||(C[19]=[b("Delete Workspace",-1)])]),_:1}),r(me,null,{default:i(()=>{var j;return[p("p",Qr,[C[20]||(C[20]=b(" Are you sure you want to delete ",-1)),p("strong",null,O(((j=N.value)==null?void 0:j.name)||"this workspace"),1),C[21]||(C[21]=b("? This action cannot be undone. ",-1))]),_.value?(g(),W(be,{key:0,type:"error",variant:"tonal",density:"comfortable",class:"mt-3"},{default:i(()=>[b(O(_.value),1)]),_:1})):X("",!0)]}),_:1}),r(De,{class:"justify-end"},{default:i(()=>[r(G,{variant:"text",color:"primary",onClick:H,disabled:P.value},{default:i(()=>[...C[22]||(C[22]=[b(" Cancel ",-1)])]),_:1},8,["disabled"]),r(G,{color:"error",variant:"flat",loading:P.value,onClick:J},{default:i(()=>[...C[23]||(C[23]=[b(" Delete ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),jr=he(Rr,[["__scopeId","data-v-a7bf0d69"]]),Br={class:"mcq-generator"},Hr={class:"mcq-generator__body"},Xr={class:"mcq-generator__inputs"},Kr={key:0,class:"mcq-generator__alert"},Jr={key:1,class:"mcq-generator__alert"},Yr={class:"mcq-generator__actions"},Zr=ge({__name:"MCQGeneratorForm",setup(e){const t=vr(),{topics:s,quantity:a,difficulty:o,allowMulti:l,onlyTF:n,userInstructions:d,loading:c,error:m,lastMessage:y}=oe(t),k=[{title:"Easy",value:"easy"},{title:"Medium",value:"medium"},{title:"Hard",value:"hard"}],x=$({get:()=>a.value,set:N=>{const S=Number.isNaN(Number(N))?1:Math.min(Math.max(Number(N),1),20);t.quantity=S}}),T=$(()=>t.canGenerate),_=$(()=>m.value?m.value.message||"Failed to generate questions.":""),A=$(()=>y.value),P=()=>{t.generate()};return Ae(()=>{t.initialise()}),se(n,N=>{N&&(t.allowMulti=!1)}),(N,S)=>(g(),V("div",Br,[p("div",Hr,[r(Le,{modelValue:h(s),"onUpdate:modelValue":S[0]||(S[0]=D=>ue(s)?s.value=D:null),label:"Topics",variant:"outlined","auto-grow":"",rows:"2","max-rows":"4",density:"comfortable",placeholder:"e.g. Photosynthesis basics, plant biology",disabled:h(c)},null,8,["modelValue","disabled"]),p("div",Xr,[r(_e,{modelValue:x.value,"onUpdate:modelValue":S[1]||(S[1]=D=>x.value=D),modelModifiers:{number:!0},label:"Number of questions",type:"number",min:"1",max:"20",variant:"outlined",density:"comfortable",disabled:h(c)},null,8,["modelValue","disabled"]),r(ye,{modelValue:h(o),"onUpdate:modelValue":S[2]||(S[2]=D=>ue(o)?o.value=D:null),items:k,label:"Difficulty",variant:"outlined",density:"comfortable",disabled:h(c)},null,8,["modelValue","disabled"])]),r(Le,{modelValue:h(d),"onUpdate:modelValue":S[3]||(S[3]=D=>ue(d)?d.value=D:null),label:"Primary instructions",variant:"outlined",rows:"2","max-rows":"4","auto-grow":"",density:"comfortable",placeholder:"Include key misconceptions or emphasise real-world examples",disabled:h(c)},null,8,["modelValue","disabled"]),r(at,{modelValue:h(n),"onUpdate:modelValue":S[4]||(S[4]=D=>ue(n)?n.value=D:null),inset:"",label:"Only True / False questions",disabled:h(c)||h(l)},null,8,["modelValue","disabled"]),r(at,{modelValue:h(l),"onUpdate:modelValue":S[5]||(S[5]=D=>ue(l)?l.value=D:null),inset:"",label:"Allow multiple correct answers",disabled:h(c)||h(n)},null,8,["modelValue","disabled"]),_.value?(g(),V("div",Kr,[r(be,{type:"error",variant:"tonal",density:"compact"},{default:i(()=>[b(O(_.value),1)]),_:1})])):X("",!0),A.value?(g(),V("div",Jr,[r(be,{type:"success",variant:"tonal",density:"compact"},{default:i(()=>[b(O(A.value),1)]),_:1})])):X("",!0)]),p("div",Yr,[r(ea),r(G,{color:"primary",variant:"flat",disabled:!T.value,loading:h(c),"prepend-icon":"mdi-timer-play",onClick:P},{default:i(()=>[...S[6]||(S[6]=[b(" Generate Questions ",-1)])]),_:1},8,["disabled","loading"])])]))}}),eo=he(Zr,[["__scopeId","data-v-aaa9347d"]]),to={class:"distractor-form"},so={class:"distractor-form__section"},ao={class:"distractor-form__selector"},ro={class:"distractor-form__preview-header"},oo={class:"distractor-form__preview-text"},io={class:"distractor-form__section"},no={class:"distractor-form__actions"},lo={class:"distractor-form__action-buttons"},co=ge({__name:"DistractorGeneratorForm",setup(e){const t=Is(),{questionId:s,instructions:a,loading:o,error:l,lastMessage:n,selectionActive:d,selectedQuestionText:c}=oe(t),m=$({get:()=>s.value,set:N=>t.setQuestionId(N)}),y=$({get:()=>a.value,set:N=>t.setInstructions(N)}),k=$(()=>s.value.trim().length>0&&!o.value),x=$(()=>l.value?l.value.message||"Failed to generate variants.":""),T=$(()=>d.value?"Click a question to use it":s.value?"Change selected question":"Select a question from the canvas"),_=()=>{t.generate()},A=()=>{t.reset()},P=()=>{d.value?t.cancelSelection():t.beginSelection()};return(N,S)=>(g(),V("div",to,[r(ve,{class:"distractor-form__divider"}),r(as,{class:"distractor-form__content",onSubmit:Fe(_,["prevent"])},{default:i(()=>[p("section",so,[p("div",ao,[r(G,{variant:"outlined",color:"primary","prepend-icon":"mdi-cursor-default-click",class:We({"distractor-form__selector-btn--active":h(d)}),onClick:Fe(P,["prevent"]),disabled:h(o)},{default:i(()=>[b(O(T.value),1)]),_:1},8,["class","disabled"]),r(Ge,{name:"fade"},{default:i(()=>[h(s)?(g(),W($e,{key:0,label:"",color:"primary",variant:"flat",size:"small"},{default:i(()=>[b(" ID: "+O(h(s)),1)]),_:1})):X("",!0)]),_:1})]),r(Ge,{name:"fade"},{default:i(()=>[h(d)?(g(),W(be,{key:0,type:"info",variant:"tonal",density:"comfortable",class:"distractor-form__selection-hint"},{default:i(()=>[...S[2]||(S[2]=[b(" Click an MCQ card on the canvas to import it here. ",-1)])]),_:1})):X("",!0)]),_:1}),r(Ge,{name:"fade"},{default:i(()=>[h(c)?(g(),W(ss,{key:0,class:"distractor-form__preview",color:"primary",variant:"tonal"},{default:i(()=>[p("div",ro,[S[4]||(S[4]=p("p",{class:"distractor-form__preview-label"},"Selected question",-1)),r(G,{variant:"text",color:"primary",size:"small","prepend-icon":"mdi-sync",onClick:Fe(P,["prevent"])},{default:i(()=>[...S[3]||(S[3]=[b(" Choose different ",-1)])]),_:1})]),p("p",oo,O(h(c)),1)]),_:1})):X("",!0)]),_:1})]),p("section",io,[r(_e,{modelValue:m.value,"onUpdate:modelValue":S[0]||(S[0]=D=>m.value=D),label:"Question ID",variant:"outlined",density:"comfortable",placeholder:"Select a question or enter the ID manually",disabled:h(o),required:""},null,8,["modelValue","disabled"]),r(Le,{modelValue:y.value,"onUpdate:modelValue":S[1]||(S[1]=D=>y.value=D),label:"Additional instructions (optional)",variant:"outlined",density:"comfortable",rows:"3","auto-grow":"",disabled:h(o),placeholder:"e.g. Focus on misconceptions or highlight similar-sounding terms"},null,8,["modelValue","disabled"])]),p("div",no,[S[7]||(S[7]=p("div",{class:"distractor-form__action-copy"},[p("p",{class:"text-caption text-medium-emphasis mb-0"}," Note: Variants are added to the selected MCQ on the current canvas. Youll see them expand under the card. ")],-1)),p("div",lo,[r(G,{variant:"text",color:"primary",onClick:A,disabled:h(o)},{default:i(()=>[...S[5]||(S[5]=[b(" Reset ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"flat","prepend-icon":"mdi-arrange-bring-forward",type:"submit",loading:h(o),disabled:h(o)||!k.value},{default:i(()=>[...S[6]||(S[6]=[b(" Generate Distractors ",-1)])]),_:1},8,["loading","disabled"])])]),r(Ge,{name:"fade"},{default:i(()=>[h(l)?(g(),W(be,{key:0,type:"error",variant:"tonal",density:"comfortable",class:"distractor-form__alert"},{default:i(()=>[b(O(x.value),1)]),_:1})):X("",!0)]),_:1}),r(Ge,{name:"fade"},{default:i(()=>[h(n)?(g(),W(be,{key:0,type:"success",variant:"tonal",density:"comfortable",class:"distractor-form__alert"},{default:i(()=>[b(O(h(n)),1)]),_:1})):X("",!0)]),_:1})]),_:1})]))}}),uo=he(co,[["__scopeId","data-v-50514e00"]]),po={class:"notes-maker"},mo={class:"notes-maker__body"},fo={class:"notes-maker__header"},ho={class:"notes-maker__header-copy"},go={class:"notes-maker__eyebrow-line"},yo={class:"notes-maker__options"},vo={key:0,class:"notes-maker__alert"},bo={key:1,class:"notes-maker__alert"},_o={key:0,class:"mt-2"},wo={class:"text-caption"},ko={key:2,class:"notes-maker__progress"},So={class:"notes-maker__actions"},xo={class:"notes-maker__action-buttons"},Co=ge({__name:"NotesMakerForm",setup(e){const t=br(),{requirements:s,includePdf:a,includePpt:o,outputDir:l,loading:n,error:d,lastMessage:c,generatedFiles:m,downloadUrls:y}=oe(t),k=$({get:()=>s.value,set:q=>t.setRequirements(q)}),x=$({get:()=>a.value,set:q=>t.setIncludePdf(q)}),T=$({get:()=>o.value,set:q=>t.setIncludePpt(q)}),_=$({get:()=>l.value,set:q=>t.setOutputDir(q)}),A=$(()=>t.canGenerate),P=$(()=>d.value?d.value.message||"Failed to generate notes.":""),N=$(()=>c.value),S=()=>{t.generate()},D=()=>{t.reset()};return Ae(()=>{}),(q,L)=>(g(),V("div",po,[p("div",mo,[p("header",fo,[p("div",ho,[p("div",go,[r(pe,{icon:"mdi-information-outline",size:"small",color:"primary"}),L[4]||(L[4]=p("span",{class:"text-caption text-medium-emphasis"}," Describe what you want to generate ",-1))])])]),r(Le,{modelValue:k.value,"onUpdate:modelValue":L[0]||(L[0]=F=>k.value=F),label:"Content Requirements",variant:"outlined","auto-grow":"",rows:"3","max-rows":"6",density:"comfortable",placeholder:"e.g. Create a summary PDF file on coding practices and methods, provide proper references",disabled:h(n),required:""},null,8,["modelValue","disabled"]),p("div",yo,[r(at,{modelValue:x.value,"onUpdate:modelValue":L[1]||(L[1]=F=>x.value=F),inset:"",label:"Generate PDF",color:"primary",disabled:h(n)},null,8,["modelValue","disabled"]),r(at,{modelValue:T.value,"onUpdate:modelValue":L[2]||(L[2]=F=>T.value=F),inset:"",label:"Generate PowerPoint",color:"primary",disabled:h(n)},null,8,["modelValue","disabled"])]),r(_e,{modelValue:_.value,"onUpdate:modelValue":L[3]||(L[3]=F=>_.value=F),label:"Output Directory (optional)",variant:"outlined",density:"comfortable",placeholder:"./output",disabled:h(n),hint:"Files will be automatically downloaded to your Downloads folder","persistent-hint":""},null,8,["modelValue","disabled"]),P.value?(g(),V("div",vo,[r(be,{type:"error",variant:"tonal",density:"compact"},{default:i(()=>[b(O(P.value),1)]),_:1})])):X("",!0),N.value?(g(),V("div",bo,[r(be,{type:"success",variant:"tonal",density:"compact"},{default:i(()=>[b(O(N.value)+" ",1),h(m).length>0?(g(),V("div",_o,[L[5]||(L[5]=p("p",{class:"text-caption mb-1"},"Generated files:",-1)),p("ul",wo,[(g(!0),V(Z,null,re(h(m),F=>(g(),V("li",{key:F},O(F),1))),128))])])):X("",!0)]),_:1})])):X("",!0),h(n)?(g(),V("div",ko,[r(ta,{indeterminate:"",color:"primary",height:"4"}),L[6]||(L[6]=p("p",{class:"text-caption text-medium-emphasis mt-2 mb-0"}," Generating your content... This may take a few moments. ",-1))])):X("",!0)]),p("div",So,[L[9]||(L[9]=p("div",{class:"notes-maker__action-copy"},[p("p",{class:"text-caption text-medium-emphasis mb-0"}," Note: Generated files will be automatically downloaded to your Downloads folder. ")],-1)),p("div",xo,[r(G,{variant:"text",color:"primary",onClick:D,disabled:h(n)},{default:i(()=>[...L[7]||(L[7]=[b(" Reset ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"flat",disabled:!A.value,loading:h(n),"prepend-icon":"mdi-file-document-plus-outline",onClick:S},{default:i(()=>[...L[8]||(L[8]=[b(" Generate Notes ",-1)])]),_:1},8,["disabled","loading"])])])]))}}),Ao=he(Co,[["__scopeId","data-v-5c020336"]]),Io={class:"d-flex align-center justify-space-between w-100"},To={class:"tools-panel__tool-meta"},Vo={key:0,class:"distractor-form__header"},Eo={class:"distractor-form__header-copy"},$o={class:"distractor-form__eyebrow-line"},Fo={class:"text-subtitle-1 font-weight-semibold mb-1"},Do={class:"text-body-2 text-medium-emphasis mb-0"},No={key:3,class:"tools-panel__cta"},Po=ge({__name:"CreativeToolkitPanel",setup(e){const t=Ue(),s=oe(t),a=$(()=>s.tools.value),o=s.expandedToolIds,l=$({get:()=>o.value,set:d=>{const c=Array.isArray(d)?d:d?[d]:[];t.setExpandedToolIds(c)}}),n=d=>{if(!(d==="mcq-generator"||d==="distractor-generator"||d==="notes-maker")){if(d==="graph-visualizer"){t.handleVisualizeGraph();return}t.executeTool(d)}};return(d,c)=>(g(),W(ie,{class:"tools-panel d-flex flex-column h-100",elevation:"2"},{default:i(()=>[r(me,{class:"pt-4 tools-panel__scroll flex-grow-1"},{default:i(()=>[r(sa,{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=m=>l.value=m),multiple:"",elevation:"0",class:"tool-expansion"},{default:i(()=>[(g(!0),V(Z,null,re(a.value,m=>(g(),W(aa,{key:m.id,value:m.id},{default:i(()=>[r(ra,{"expand-icon":"mdi-chevron-down"},{default:i(()=>[p("div",Io,[p("div",To,[r(we,{color:"primary",size:"44",variant:"flat"},{default:i(()=>[r(pe,{icon:m.icon,size:"22",color:"white"},null,8,["icon"])]),_:2},1024),p("div",null,[m.is_new?(g(),V("header",Vo,[p("div",Eo,[p("div",$o,[r($e,{label:"",size:"x-small",color:"orange",variant:"flat",class:"distractor-form__badge"},{default:i(()=>[...c[1]||(c[1]=[b(" New ",-1)])]),_:1})])])])):X("",!0),p("p",Fo,O(m.name),1),p("p",Do,O(m.description),1)])])])]),_:2},1024),r(oa,null,{default:i(()=>[m.id==="mcq-generator"?(g(),W(eo,{key:0})):m.id==="distractor-generator"?(g(),W(uo,{key:1})):m.id==="notes-maker"?(g(),W(Ao,{key:2})):(g(),V("div",No,[r(G,{color:"primary",variant:"flat",block:"",style:{"padding-block":"14px"},"prepend-icon":"mdi-play-circle-outline",onClick:()=>n(m.id)},{default:i(()=>[b(O(m.quickAction),1)]),_:2},1032,["onClick"])]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),Mo=he(Po,[["__scopeId","data-v-2a28cf98"]]),Oo={class:"files-pane"},Lo={class:"files-pane__actions"},Uo={key:0,class:"files-pane__state"},qo={key:1,class:"files-pane__state"},Go={key:2,class:"files-pane__state"},zo={class:"chat-pane"},Wo={key:0,class:"chat-pane__state"},Qo={class:"text-body-2 text-medium-emphasis mt-2 mb-0"},Ro={key:1,class:"chat-pane__state"},jo=["innerHTML"],Bo={class:"chat-pane__composer"},Ho={class:"chat-pane__composer-actions"},Xo=ge({__name:"ToolsPanel",setup(e){const t=or(),s=Ya(),a=rr(),o=ee(),l=ne(),{activeTab:n}=oe(t),{documents:d,loading:c,error:m,menuOpen:y,uploadDialogOpen:k,linksDialogOpen:x,uploadFiles:T,uploadInProgress:_,linkEntries:A,linkSubmissionInProgress:P,hasDocuments:N,canSubmitFiles:S,canSubmitLinks:D}=oe(s),{messages:q,inputValue:L,streaming:F,error:u,hasMessages:f,canSend:v}=oe(a),I=Y(null),M=$({get:()=>T.value,set:B=>{s.setUploadFiles(B)}}),H=B=>B==="user"?"chat-bubble--user":"chat-bubble--assistant",J=B=>B.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),K=B=>{let w=J(B);return w=w.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),w=w.replace(/\*([^*]+)\*/g,"<em>$1</em>"),w=w.replace(/`([^`]+)`/g,"<code>$1</code>"),w},z=B=>{if(!B)return"";const w=B.split(`
`),R=[];let xe=[],Te=!1,Xe=[];const pt=()=>{if(!xe.length)return;const Ve=xe.map(Ke=>`<li>${K(Ke)}</li>`).join("");R.push(`<ul>${Ve}</ul>`),xe=[]},$t=()=>{Xe.length&&(R.push(`<pre><code>${J(Xe.join(`
`))}</code></pre>`),Xe=[])};return w.forEach(Ve=>{const Ke=Ve.trim();if(Ke.startsWith("```")){Te?($t(),Te=!1):(pt(),Te=!0);return}if(Te){Xe.push(Ve);return}const Ft=Ve.match(/^\s*[-*]\s+(.*)$/);if(Ft){xe.push(Ft[1]);return}pt();const mt=Ve.match(/^(#{1,3})\s+(.*)$/);if(mt){const Dt=Math.min(mt[1].length+2,6);R.push(`<h${Dt}>${K(mt[2])}</h${Dt}>`);return}if(!Ke){R.push("");return}R.push(`<p>${K(Ve)}</p>`)}),Te?$t():pt(),R.filter(Boolean).join("")},C=B=>{if(!B)return"recently";const w=new Date(B);return Number.isNaN(w.getTime())?"recently":w.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})},j=()=>{s.openUploadDialog()},ae=()=>{s.openLinksDialog()},ke=()=>{s.closeUploadDialog()},qe=()=>{s.closeLinksDialog()},Pe=()=>{s.addLinkField()},Ie=B=>{s.removeLinkField(B)},de=(B,w)=>{s.updateLinkField(B,w)},Se=()=>{s.uploadSelectedFiles()},U=()=>{s.submitLinks()},E=()=>{s.fetchDocuments()},Q=()=>{a.clearConversation()},Fs=()=>{a.sendMessage()};return Ae(()=>{s.fetchDocuments()}),se(()=>o.workspaceId,(B,w)=>{(B&&B!==w||B&&!w)&&s.fetchDocuments()},{immediate:!0}),se(()=>l.userId,(B,w)=>{B&&B!==w&&a.hydrateHistoryForCurrentUser()},{immediate:!0}),se(()=>q.value.map(B=>`${B.id}:${B.content}`).join("|"),async()=>{await _t();const B=I.value;B&&(B.scrollTop=B.scrollHeight)},{immediate:!0}),(B,w)=>(g(),W(ie,{class:"tool-shell",elevation:"2"},{default:i(()=>[r(rs,{modelValue:h(n),"onUpdate:modelValue":w[0]||(w[0]=R=>ue(n)?n.value=R:null),class:"tool-shell__tabs",color:"primary",grow:""},{default:i(()=>[r(Ye,{value:"files",class:"tool-shell__tab"},{default:i(()=>[...w[7]||(w[7]=[p("span",null,"Files",-1)])]),_:1}),r(Ye,{value:"search",class:"tool-shell__tab"},{default:i(()=>[...w[8]||(w[8]=[p("span",null,"Search with AI",-1)])]),_:1}),r(Ye,{value:"creative",class:"tool-shell__tab"},{default:i(()=>[...w[9]||(w[9]=[p("span",null,"AI Toolkit",-1)])]),_:1})]),_:1},8,["modelValue"]),r(os,{modelValue:h(n),"onUpdate:modelValue":w[3]||(w[3]=R=>ue(n)?n.value=R:null),class:"tool-shell__window"},{default:i(()=>[r(Ze,{value:"files",class:"tool-shell__pane"},{default:i(()=>[p("div",Oo,[p("div",Lo,[r(G,{variant:"text",color:"primary","prepend-icon":"mdi-refresh",loading:h(c),onClick:E},{default:i(()=>[...w[10]||(w[10]=[b(" Refresh ",-1)])]),_:1},8,["loading"]),r(ts,{modelValue:h(y),"onUpdate:modelValue":w[1]||(w[1]=R=>ue(y)?y.value=R:null),location:"bottom",offset:8,transition:"fade-transition"},{activator:i(({props:R})=>[r(G,Zt({color:"primary",variant:"flat","prepend-icon":"mdi-plus"},R),{default:i(()=>[...w[11]||(w[11]=[b(" Add Content ",-1)])]),_:1},16)]),default:i(()=>[r(Ee,null,{default:i(()=>[r(le,{onClick:j},{default:i(()=>[r(Qe,null,{default:i(()=>[...w[12]||(w[12]=[b("Upload Files",-1)])]),_:1})]),_:1}),r(le,{onClick:ae},{default:i(()=>[r(Qe,null,{default:i(()=>[...w[13]||(w[13]=[b("Add Webpage Links",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),h(c)?(g(),V("div",Uo,[r(Be,{indeterminate:"",color:"primary",size:"32"}),w[14]||(w[14]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-0"},"Loading documents",-1))])):h(m)?(g(),V("div",qo,[r(pe,{size:"32",color:"primary"},{default:i(()=>[...w[15]||(w[15]=[b("mdi-alert-circle-outline",-1)])]),_:1}),w[17]||(w[17]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-2"},"Failed to load documents.",-1)),r(G,{color:"primary",variant:"flat",onClick:E},{default:i(()=>[...w[16]||(w[16]=[b("Try Again",-1)])]),_:1})])):h(N)?(g(),W(Ee,{key:3,class:"files-pane__list",density:"comfortable"},{default:i(()=>[(g(!0),V(Z,null,re(h(d),R=>(g(),W(le,{key:R.id,class:"files-pane__list-item"},{prepend:i(()=>[r(we,{size:"36",color:"primary",variant:"flat"},{default:i(()=>[r(pe,{size:"18",color:"white"},{default:i(()=>[...w[20]||(w[20]=[b("mdi-file-document",-1)])]),_:1})]),_:1})]),default:i(()=>[r(Qe,{class:"text-subtitle-2"},{default:i(()=>[b(O(R.name),1)]),_:2},1024),r(na,{class:"text-caption text-medium-emphasis"},{default:i(()=>[b(" Updated "+O(C(R.updatedAt))+"  Status: "+O(R.status||"unknown"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(g(),V("div",Go,[r(pe,{size:"32",color:"primary"},{default:i(()=>[...w[18]||(w[18]=[b("mdi-folder-outline",-1)])]),_:1}),w[19]||(w[19]=p("p",{class:"text-body-2 text-medium-emphasis mt-3 mb-0"}," No documents available yet. Upload files or add links to begin. ",-1))]))])]),_:1}),r(Ze,{value:"search",class:"tool-shell__pane"},{default:i(()=>[p("div",zo,[p("div",{class:"chat-pane__messages",ref_key:"messagesContainer",ref:I},[h(u)?(g(),V("div",Wo,[r(pe,{size:"28",color:"primary"},{default:i(()=>[...w[21]||(w[21]=[b("mdi-alert-circle-outline",-1)])]),_:1}),p("p",Qo,O(h(u).message||"Something went wrong"),1)])):h(f)?(g(!0),V(Z,{key:2},re(h(q),R=>(g(),V("div",{key:R.id,class:We(["chat-bubble",H(R.role)])},[p("div",{class:"chat-bubble__content",innerHTML:z(R.content)},null,8,jo)],2))),128)):(g(),V("div",Ro,[...w[22]||(w[22]=[p("p",{class:"text-body-2 text-medium-emphasis mt-2 mb-0"},"Start a conversation to see AI responses.",-1)])]))],512),p("div",Bo,[r(Le,{variant:"outlined",density:"comfortable",rows:"2","max-rows":"4","auto-grow":"",placeholder:"Type your question...",modelValue:h(L),"onUpdate:modelValue":w[2]||(w[2]=R=>ue(L)?L.value=R:null),disabled:h(F)},null,8,["modelValue","disabled"]),p("div",Ho,[r(G,{variant:"text",color:"primary","prepend-icon":"mdi-broom",onClick:Q,disabled:!h(f)||h(F)},{default:i(()=>[...w[23]||(w[23]=[b(" Clear ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"flat","prepend-icon":"mdi-send",onClick:Fs,disabled:!h(v),loading:h(F)},{default:i(()=>[...w[24]||(w[24]=[b(" Send ",-1)])]),_:1},8,["disabled","loading"])])])])]),_:1}),r(Ze,{value:"creative",class:"tool-shell__pane"},{default:i(()=>[r(Mo)]),_:1})]),_:1},8,["modelValue"]),r(Re,{modelValue:h(k),"onUpdate:modelValue":w[5]||(w[5]=R=>ue(k)?k.value=R:null),"max-width":"520",persistent:""},{default:i(()=>[r(ie,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[...w[25]||(w[25]=[b("Upload Files",-1)])]),_:1}),r(me,null,{default:i(()=>[r(ia,{variant:"outlined",multiple:"","show-size":"",accept:".pdf,.doc,.docx,.txt,.md,.ppt,.pptx,.xls,.xlsx",label:"Select files","prepend-inner-icon":"mdi-paperclip",modelValue:M.value,"onUpdate:modelValue":w[4]||(w[4]=R=>M.value=R)},null,8,["modelValue"])]),_:1}),r(De,{class:"justify-end"},{default:i(()=>[r(G,{variant:"text",onClick:ke},{default:i(()=>[...w[26]||(w[26]=[b("Cancel",-1)])]),_:1}),r(G,{color:"primary",variant:"flat",disabled:!h(S),loading:h(_),onClick:Se},{default:i(()=>[...w[27]||(w[27]=[b(" Upload ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(Re,{modelValue:h(x),"onUpdate:modelValue":w[6]||(w[6]=R=>ue(x)?x.value=R:null),"max-width":"520",persistent:""},{default:i(()=>[r(ie,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[...w[28]||(w[28]=[b("Add Webpage Links",-1)])]),_:1}),r(me,{class:"d-flex flex-column gap-3"},{default:i(()=>[(g(!0),V(Z,null,re(h(A),(R,xe)=>(g(),W(_e,{key:`link-${xe}`,variant:"outlined",density:"comfortable",label:"Web link",placeholder:"https://example.com/article","append-inner-icon":h(A).length>1?"mdi-close":void 0,"onClick:appendInner":()=>Ie(xe),"onUpdate:modelValue":Te=>de(xe,Te),"model-value":R},null,8,["append-inner-icon","onClick:appendInner","onUpdate:modelValue","model-value"]))),128)),r(G,{variant:"text",color:"primary","prepend-icon":"mdi-plus",onClick:Pe},{default:i(()=>[...w[29]||(w[29]=[b(" Add another link ",-1)])]),_:1})]),_:1}),r(De,{class:"justify-end"},{default:i(()=>[r(G,{variant:"text",onClick:qe},{default:i(()=>[...w[30]||(w[30]=[b("Cancel",-1)])]),_:1}),r(G,{color:"primary",variant:"flat",disabled:!h(D),loading:h(P),onClick:U},{default:i(()=>[...w[31]||(w[31]=[b(" Save Links ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Ko=he(Xo,[["__scopeId","data-v-2a23c04a"]]),Jo={class:"d-flex align-center justify-space-between flex-wrap gap-3"},Yo={class:"d-flex align-center gap-2"},Zo={class:"question-card__header-actions"},ei=["innerHTML"],ti={class:"options"},si={class:"option__index-text"},ai={class:"option-text"},ri={class:"metadata__value"},oi={key:0,class:"variants"},ii={class:"variant-card__header"},ni={class:"variant-card__options"},li={class:"variant-option__index-text"},di={class:"variant-option__text"},ci={key:0,class:"variant-card__rationale"},ui=ge({__name:"MCQCard",props:{mcq:{},showActions:{type:Boolean,default:!0},selectable:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},emits:["delete","select"],setup(e,{expose:t,emit:s}){const a=e,o=s,l=$(()=>a.mcq.type==="mcq"?"MCQ":a.mcq.type==="multiple_response"?"Multiple Response":a.mcq.type==="true_false"?"True / False":"Question"),n=Y(!1),d=$(()=>Array.isArray(a.mcq.variants)?a.mcq.variants:[]),c=$(()=>d.value.length>0),m=$(()=>{var D;return(D={easy:"Easy",medium:"Medium",hard:"Hard"}[a.mcq.difficultyLevel])!=null?D:a.mcq.difficultyLevel}),y=S=>String.fromCharCode(65+S),k=S=>S.difficulty_level?`${S.difficulty_level.replace(/_/g," ")}`.replace(/\b\w/g,D=>D.toUpperCase()):"Variant",x=()=>o("delete",a.mcq.id),T=()=>n.value=!n.value,_=()=>{a.selectable&&o("select",{id:a.mcq.id,question:a.mcq.question})};function A(S){if(!S)return"";const D=S.replace(/<pre>\s*<code(?![^>]*class=)/gim,'<pre><code class="language-python"');return Ds.sanitize(D,{USE_PROFILES:{html:!0}})}const P=$(()=>A(a.mcq.question)),N={mounted(S){Mt.highlightAllUnder(S)},updated(S){Mt.highlightAllUnder(S)}};return t({}),Ae(()=>{}),se(()=>a.mcq.question,()=>{}),(S,D)=>(g(),W(ie,{class:We(["question-card",{"question-card--selectable":e.selectable,"question-card--selected":e.selected,"question-card--selection-active":e.selectable&&!e.selected}]),variant:"outlined",onClick:_},{default:i(()=>[r(je,null,{default:i(()=>[p("div",Jo,[p("div",Yo,[r($e,{label:"",color:"primary",variant:"flat",size:"small",class:"chip--contrast"},{default:i(()=>[b(O(l.value),1)]),_:1})]),p("div",Zo,[c.value?(g(),W(G,{key:0,variant:"text",size:"small",color:"primary","prepend-icon":"mdi-arrange-bring-forward",onClick:Fe(T,["stop"])},{default:i(()=>[b(O(n.value?"Hide":"Show")+" Variants ("+O(d.value.length)+") ",1)]),_:1})):X("",!0),e.showActions?(g(),W(G,{key:1,variant:"flat",size:"small",color:"primary","prepend-icon":"mdi-delete-outline",onClick:Fe(x,["stop"])},{default:i(()=>[...D[0]||(D[0]=[b(" Remove ",-1)])]),_:1})):X("",!0)])])]),_:1}),r(ve,{class:"mx-6"}),r(me,null,{default:i(()=>[es(p("div",{class:"question-text",innerHTML:P.value},null,8,ei),[[N]]),p("div",ti,[(g(!0),V(Z,null,re(e.mcq.options,(q,L)=>(g(),V("div",{key:`${e.mcq.id}-${L}`,class:We(["option",{"option--correct":e.mcq.correctOptions.includes(L)}])},[r(we,{size:"28",color:"primary",variant:"flat",class:"option__index"},{default:i(()=>[p("span",si,O(y(L)),1)]),_:2},1024),p("span",ai,O(q),1),e.mcq.correctOptions.includes(L)?(g(),W(pe,{key:0,size:"18",color:"rgba(17, 24, 39, 1)"},{default:i(()=>[...D[1]||(D[1]=[b(" mdi-check-circle-outline ",-1)])]),_:1})):X("",!0)],2))),128))]),r(ve,{class:"my-4"}),r(st,{class:"metadata",align:"stretch","no-gutters":""},{default:i(()=>[r(ce,{cols:"12",md:"2",class:"pr-md-4 mb-4 mb-md-0"},{default:i(()=>[D[2]||(D[2]=p("p",{class:"metadata__label"},"Difficulty Level",-1)),r($e,{label:"",color:"primary",variant:"outlined",size:"small",class:"text-uppercase"},{default:i(()=>[b(O(m.value),1)]),_:1})]),_:1}),r(ce,{cols:"12",md:"7",class:"pr-md-4 mb-4 mb-md-0"},{default:i(()=>[D[3]||(D[3]=p("p",{class:"metadata__label"},"Source",-1)),p("p",ri,O(e.mcq.source),1)]),_:1}),r(ce,{cols:"12",md:"3"},{default:i(()=>[D[4]||(D[4]=p("p",{class:"metadata__label"},"Tag",-1)),r($e,{label:"",size:"small",color:"primary",variant:"outlined"},{default:i(()=>[b(O(e.mcq.tag),1)]),_:1})]),_:1})]),_:1}),r(la,null,{default:i(()=>[n.value?(g(),V("div",oi,[(g(!0),V(Z,null,re(d.value,q=>(g(),V("div",{key:q.id||k(q),class:"variant-card"},[p("div",ii,[r($e,{label:"",size:"small",color:"primary",variant:"outlined"},{default:i(()=>[b(O(k(q)),1)]),_:2},1024)]),p("div",ni,[(g(!0),V(Z,null,re(q.options,(L,F)=>(g(),V("div",{key:`${q.id||k(q)}-${F}`,class:We(["variant-option",{"variant-option--correct":q.correct_answers.includes(F)}])},[r(we,{size:"24",color:"primary",variant:"flat",class:"variant-option__index"},{default:i(()=>[p("span",li,O(y(F)),1)]),_:2},1024),p("span",di,O(L),1)],2))),128))]),q.rationale?(g(),V("p",ci,O(q.rationale),1)):X("",!0)]))),128))])):X("",!0)]),_:1})]),_:1})]),_:1},8,["class"]))}}),Ts=he(ui,[["__scopeId","data-v-b34eca35"]]),pi={key:0,class:"pa-2",style:{"max-width":"320px"}},mi={class:"text-subtitle-1 font-weight-bold"},fi={key:0},hi={class:"d-flex align-center w-100"},gi={class:"text-medium-emphasis mr-2",style:{"min-width":"96px"}},yi=["title"],vi={key:1},bi={class:"d-flex align-center w-100"},_i={class:"text-medium-emphasis mr-2",style:{"min-width":"96px"}},wi=["title"],ki={class:"d-flex align-center ga-2"},Si=["title"],xi={__name:"GraphPropertiesView",setup(e){const t=Et(),s=$(()=>t.selectedNode),a=$(()=>t.focusedNode),o=$(()=>t.selectedEdge),l=$(()=>t.focusedEdge),n=$(()=>t.sigmaGraph),d=$(()=>t.rawGraph),c=$(()=>t.graphDataVersion),m=Y(null),y=Y(null);function k(u){var f,v,I;return u?(I=(f=u.properties)==null?void 0:f.entity_id)!=null?I:String((v=u.id)!=null?v:""):""}function x(u){var J,K,z;const f=n.value,v=d.value;if(!f||!v||!f.hasNode(String(u)))return null;const I=v.getNode(String(u));if(!I)return null;const M=(J=f.degree(String(u)))!=null?J:0,H=[];try{const C=f.edges(String(u));for(const j of C){if(!f.hasEdge(j))continue;const ae=f.getEdgeAttributes(j)||{},ke=(K=ae.source)!=null?K:f.source(j),qe=(z=ae.target)!=null?z:f.target(j),Pe=String(ke)===String(u),Ie=Pe?qe:ke;if(!f.hasNode(String(Ie)))continue;const de=v.getNode(String(Ie));de&&H.push({type:Pe?"Out":"In",id:String(Ie),label:k(de)})}}catch{}return{...I,degree:M,relationships:H}}function T(u){const f=n.value,v=d.value;if(!f||!v||!f.hasEdge(String(u)))return null;const I=v.edgeDynamicIdMap[String(u)],M=I!==void 0?v.edges[I]:null;if(!M)return null;let H,J;return f.hasNode(String(M.source))&&(H=v.getNode(String(M.source))),f.hasNode(String(M.target))&&(J=v.getNode(String(M.target))),{...M,dynamicId:String(u),sourceNode:H,targetNode:J}}function _(){if(a.value){m.value="node",y.value=x(a.value);return}if(s.value){m.value="node",y.value=x(s.value);return}if(l.value){m.value="edge",y.value=T(l.value);return}if(o.value){m.value="edge",y.value=T(o.value);return}m.value=null,y.value=null}se([a,s,l,o,n,d,c],_,{immediate:!0});async function A(u,f,v,I){await t.updateNodeAndSelect(u,f,v,I)}async function P(u,f,v,I,M,H){await t.updateEdgeAndSelect(u,f,v,I,M,H)}function N(u){t.setSelectedNode(String(u),!0)}const S=Y(""),D=Y("");function q(){S.value="",D.value=""}async function L(u){var M,H,J,K,z,C,j,ae;if(!y.value)return;const f=S.value,v=D.value,I=y.value;try{m.value==="node"?await A(I.id,(H=(M=I.properties)==null?void 0:M.entity_id)!=null?H:I.id,f,v):m.value==="edge"&&await P(I.id,I.dynamicId,(z=(K=(J=I.sourceNode)==null?void 0:J.properties)==null?void 0:K.entity_id)!=null?z:I.source,(ae=(j=(C=I.targetNode)==null?void 0:C.properties)==null?void 0:j.entity_id)!=null?ae:I.target,f,v)}finally{q(),_()}}function F(u,f){return u==="node"?f==="description"||f==="entity_id":u==="edge"?f==="description"||f==="keywords":!1}return(u,f)=>y.value?(g(),V("div",pi,[r(ie,{class:"bg-surface opacity-95",elevation:"8",rounded:"lg",border:""},{default:i(()=>[r(Ce,{class:"d-flex align-center justify-space-between py-2"},{default:i(()=>[p("div",mi,O(m.value==="node"?"Node":"Edge")+" Properties ",1)]),_:1}),r(ve),r(me,{class:"py-2"},{default:i(()=>[m.value==="node"?(g(),W(Ee,{key:0,density:"compact",class:"py-0"},{default:i(()=>{var v;return[r(h(le),{title:"ID",subtitle:String(y.value.id)},null,8,["subtitle"]),r(h(le),{title:"Labels",subtitle:Array.isArray(y.value.labels)?y.value.labels.join(", "):"",onClick:f[0]||(f[0]=I=>N(y.value.id)),class:"cursor-pointer"},null,8,["subtitle"]),r(h(le),{title:"Degree",subtitle:String((v=y.value.degree)!=null?v:0)},null,8,["subtitle"])]}),_:1})):(g(),W(Ee,{key:1,density:"compact",class:"py-0"},{default:i(()=>[r(h(le),{title:"ID",subtitle:String(y.value.id)},null,8,["subtitle"]),y.value.type?(g(),W(h(le),{key:0,title:"Type",subtitle:String(y.value.type)},null,8,["subtitle"])):X("",!0),r(h(le),{title:"Source",subtitle:y.value.sourceNode?y.value.sourceNode.labels.join(", "):String(y.value.source),class:"cursor-pointer",onClick:f[1]||(f[1]=v=>N(y.value.source))},null,8,["subtitle"]),r(h(le),{title:"Target",subtitle:y.value.targetNode?y.value.targetNode.labels.join(", "):String(y.value.target),class:"cursor-pointer",onClick:f[2]||(f[2]=v=>N(y.value.target))},null,8,["subtitle"])]),_:1}))]),_:1}),r(ve),r(me,{class:"py-2"},{default:i(()=>[f[7]||(f[7]=p("div",{class:"text-body-2 text-primary font-weight-medium mb-1"},"Properties",-1)),r(Ee,{density:"compact",class:"py-0",style:{"max-height":"280px",overflow:"auto"}},{default:i(()=>[(g(!0),V(Z,null,re(y.value.properties||{},(v,I)=>(g(),V(Z,{key:I},[I!=="created_at"?(g(),V(Z,{key:0},[F(m.value,I)?(g(),V("div",fi,[r(h(le),null,{default:i(()=>[p("div",hi,[p("div",gi,O(I),1),S.value===I?(g(),V(Z,{key:0},[r(_e,{modelValue:D.value,"onUpdate:modelValue":f[3]||(f[3]=M=>D.value=M),"hide-details":"",density:"compact",variant:"outlined",class:"flex-1 mr-2"},null,8,["modelValue"]),r(G,{size:"small",color:"primary",variant:"flat",class:"mr-1",onClick:f[4]||(f[4]=M=>L())},{default:i(()=>[...f[5]||(f[5]=[b(" Save ",-1)])]),_:1}),r(G,{size:"small",variant:"text",onClick:q},{default:i(()=>[...f[6]||(f[6]=[b("Cancel",-1)])]),_:1})],64)):(g(),V("div",{key:1,class:"flex-1 px-2 py-1 rounded bg-primary-container text-primary-on-container overflow-hidden text-truncate",title:typeof v=="string"?v:JSON.stringify(v,null,2)},O(typeof v=="string"?v:JSON.stringify(v)),9,yi))])]),_:2},1024),r(ve)])):(g(),V("div",vi,[r(h(le),null,{default:i(()=>[p("div",bi,[p("div",_i,O(I),1),p("div",{class:"flex-1 px-2 py-1 rounded bg-surface-variant text-on-surface-variant overflow-hidden text-truncate",title:typeof v=="string"?v:JSON.stringify(v,null,2)},O(typeof v=="string"?v:JSON.stringify(v)),9,wi)])]),_:2},1024),r(ve)]))],64)):X("",!0)],64))),128))]),_:1})]),_:1}),m.value==="node"&&y.value.relationships&&y.value.relationships.length?(g(),V(Z,{key:0},[r(ve),r(me,{class:"py-2"},{default:i(()=>[f[8]||(f[8]=p("div",{class:"text-body-2 text-success font-weight-medium mb-1"},"Relationships",-1)),r(Ee,{density:"compact",class:"py-0",style:{"max-height":"200px",overflow:"auto"}},{default:i(()=>[(g(!0),V(Z,null,re(y.value.relationships,v=>(g(),W(h(le),{key:v.id+":"+v.type,class:"cursor-pointer",onClick:I=>N(v.id)},{default:i(()=>[p("div",ki,[r($e,{size:"x-small",label:"",variant:"flat"},{default:i(()=>[b(O(v.type),1)]),_:2},1024),p("div",{class:"text-truncate",title:v.label},O(v.label),9,Si)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})],64)):X("",!0)]),_:1})])):X("",!0)}},Ci=he(xi,[["__scopeId","data-v-8db22cf5"]]),Ai={class:"graph-viewer",style:{position:"relative",height:"100%",width:"100%",overflow:"hidden"}},Ii={class:"d-flex align-center ga-2"},Ti={style:{position:"absolute",top:"12px",right:"12px","z-index":"20","max-width":"340px"}},Vi={class:"d-flex flex-column align-center ga-3"},Xt=4,Vs={__name:"GraphViewer",setup(e){const t=Y(null),s=Et(),a=Ue();Y(!1);const o=$(()=>s.isFetching),l=Y(!0);let n=null,d=null;const c={allowInvalidContainer:!0,defaultNodeType:"default",defaultEdgeType:"curvedNoArrow",renderEdgeLabels:!1,labelGridCellSize:100,labelRenderedSizeThreshold:10,enableEdgeEvents:!0,labelColor:{color:"#000",attribute:"labelColor"},edgeLabelColor:{color:"#000",attribute:"labelColor"},edgeLabelSize:15,labelSize:20,defaultNodeSize:8,minNodeSize:1,maxNodeSize:12,defaultEdgeSize:8,minEdgeSize:8,maxEdgeSize:20,edgeProgramClasses:{arrow:Hs,curvedArrow:Bs,curvedNoArrow:zs()},nodeProgramClasses:{default:js,circel:Rs,point:Qs}};function m(u){const f=u*.618033988749895%1,v=.8,I=.95,M=I*v,H=f*6,J=M*(1-Math.abs(H%2-1));let K=0,z=0,C=0;H<1?[K,z,C]=[M,J,0]:H<2?[K,z,C]=[J,M,0]:H<3?[K,z,C]=[0,M,J]:H<4?[K,z,C]=[0,J,M]:H<5?[K,z,C]=[J,0,M]:[K,z,C]=[0,0,M];const j=I-M,ae=ke=>Math.round((ke+j)*255);return`rgb(${ae(K)},${ae(z)},${ae(C)})`}function y(u){if(!u||u.order===0)return;Xs.assign(u,{nodeCommunityAttribute:"community"});const f=new Set;u.forEachNode((I,M)=>f.add(M.community));const v={};Array.from(f).forEach((I,M)=>{v[String(I)]=m(M)}),u.forEachNode((I,M)=>u.setNodeAttribute(I,"color",v[String(M.community)]))}function k(u){!u||u.order===0||u.forEachNode(f=>{const v=u.degree(f),K=Math.max(1,Math.min(40,5+Math.log2(1+v)*4));u.setNodeAttribute(f,"size",K)})}function x(u){!u||u.order===0||Ks.assign(u,{iterations:100,settings:{scalingRatio:4,gravity:15,strongGravityMode:!1}})}function T(){if(!n)return;const u=n.getCamera();n.getCustomBBox()&&n.setCustomBBox(null),u.animatedReset({duration:400})}function _(){if(n){try{n.kill()}catch{}n=null}s.setSigmaInstance(null)}function A(u){t.value&&(_(),d=u||new Je,n=new Ws(d,t.value,c),s.setSigmaInstance(n),n.on("upNode",F),n.on("mouseupbody",F),n.on("enterNode",()=>{t.value.style.cursor="pointer"}),n.on("leaveNode",()=>{t.value.style.cursor="default"}),n.on("clickNode",({node:f})=>{N||S||s.setSelectedNode(f,!0)}),n.on("downNode",q),n.on("mousemovebody",L),n.on("mouseup",F),n.on("enterNode",({node:f})=>s.setFocusedNode(f)),n.on("leaveNode",()=>s.setFocusedNode(null)))}let P=null,N=!1,S=!1,D={x:0,y:0};function q(u){var f,v,I,M;!l.value||!d||(P=u.node,N=!0,S=!1,D={x:u.x,y:u.y},d.setNodeAttribute(P,"highlighted",!0),u.preventSigmaDefault(),(v=(f=u.original)==null?void 0:f.preventDefault)==null||v.call(f),(M=(I=u.original)==null?void 0:I.stopPropagation)==null||M.call(I))}function L(u){var v,I,M,H;if(!l.value||!N||!P||!n||!d)return;if(!S){const J=u.x-D.x,K=u.y-D.y;J*J+K*K>Xt*Xt&&(S=!0)}const f=n.viewportToGraph({x:u.x,y:u.y});d.setNodeAttribute(P,"x",f.x),d.setNodeAttribute(P,"y",f.y),u.preventSigmaDefault(),(I=(v=u.original)==null?void 0:v.preventDefault)==null||I.call(v),(H=(M=u.original)==null?void 0:M.stopPropagation)==null||H.call(M)}function F(u){var f,v,I,M,H;l.value&&(P&&d&&(d.removeNodeAttribute(P,"highlighted"),P=null),N=!1,(f=u==null?void 0:u.preventSigmaDefault)==null||f.call(u),(I=(v=u==null?void 0:u.original)==null?void 0:v.preventDefault)==null||I.call(v),(H=(M=u==null?void 0:u.original)==null?void 0:M.stopPropagation)==null||H.call(M))}return se(()=>s.sigmaGraph,async u=>{if(A(u||new Je),await _t(),n&&u&&u.order>0){try{y(u)}catch{}k(u),x(u),n.refresh(),T()}},{immediate:!0}),Ae(()=>{A(new Je)}),se(()=>s.sigmaGraph,u=>{!n||!u||(y(u),k(u),x(u),n.refresh(),T())}),Ns(()=>{_()}),(u,f)=>(g(),V("div",Ai,[r(ie,{class:"pa-3",elevation:"8",density:"comfortable",style:{position:"absolute",top:"12px",left:"12px","z-index":"10","min-width":"220px"}},{default:i(()=>[p("div",Ii,[r(G,{variant:"flat",onClick:f[0]||(f[0]=v=>h(a).loadGraph()),"prepend-icon":"mdi-refresh"},{default:i(()=>[...f[1]||(f[1]=[b(" Refresh ",-1)])]),_:1}),r(G,{color:"primary",variant:"flat",onClick:T},{default:i(()=>[...f[2]||(f[2]=[b(" Reset camera ",-1)])]),_:1})])]),_:1}),p("div",{ref_key:"containerRef",ref:t,class:"sigma-viewport",style:{height:"100%",width:"100%",background:"var(--v-theme-background)","user-select":"none"}},null,512),es(p("div",Ti,[r(Ci)],512),[[Ps,h(s).focusedNode]]),r(da,{"model-value":o.value,class:"align-center justify-center",scrim:"rgba(0,0,0,0.65)",persistent:""},{default:i(()=>[r(ie,{class:"pa-4",elevation:"12"},{default:i(()=>[p("div",Vi,[r(Be,{indeterminate:"",size:"32",width:"4",color:"primary"}),f[3]||(f[3]=p("div",{class:"text-body-2"},"Loading Graph Data",-1))])]),_:1})]),_:1},8,["model-value"])]))}},Ei={class:"canvas-panel__header"},$i={class:"canvas-panel__actions"},Fi={class:"canvas-panel__tab"},Di={class:"canvas-panel__pane"},Ni={key:0,class:"canvas-panel__viewer"},Pi={key:0,class:"canvas-panel__loading"},Mi={key:1,class:"canvas-panel__empty"},Oi={key:2,class:"canvas-panel__list"},Li=ge({__name:"CanvasPanel",setup(e){const t=Ue(),s=Is(),{tabs:a,viewerTabs:o,activeTabId:l,activeTab:n,hasActiveOutputs:d,canAddTab:c,creatingCanvas:m}=oe(t),{selectionActive:y,questionId:k}=oe(s),x=$({get:()=>l.value,set:F=>{typeof F=="string"&&t.setActiveTab(F)}}),T=$(()=>d.value),_=F=>t.isDeletingCanvas(F),A=F=>t.isCanvasLoading(F),P=async()=>{if(!(!c.value||m.value))try{await t.addTab()}catch(F){console.error("Failed to create canvas",F)}},N=async F=>{if(F.isViewer){t.removeViewerTab(F.id);return}S(F.id)},S=async F=>{const u=a.value.find(v=>v.id===F);if(!u)return;if(window.confirm(`Close ${u.name}? All outputs on this canvas will be removed.`))try{await t.closeTab(F)}catch(v){console.error("Failed to close canvas",v)}},D=()=>{if(!T.value)return;window.confirm("Discard all outputs on this canvas?")&&t.discardActiveTabOutputs()},q=async F=>{try{await t.deleteOutputById(F)}catch(u){console.error("Failed to delete output",u)}},L=F=>{y.value&&s.completeSelection({id:F.id,text:F.question})};return(F,u)=>(g(),W(ie,{class:"canvas-panel",elevation:"2"},{default:i(()=>[r(je,{class:"pb-0"},{default:i(()=>[p("div",Ei,[p("div",$i,[r(G,{variant:"outlined",color:"primary","prepend-icon":"mdi-broom",disabled:!T.value,onClick:D},{default:i(()=>[...u[2]||(u[2]=[b(" Clear Canvas ",-1)])]),_:1},8,["disabled"]),r(G,{color:"primary",variant:"flat","prepend-icon":"mdi-plus-circle-outline",disabled:!h(c)||h(m),loading:h(m),onClick:P},{default:i(()=>[...u[3]||(u[3]=[b(" New Canvas ",-1)])]),_:1},8,["disabled","loading"])])])]),_:1}),r(me,{class:"canvas-panel__body"},{default:i(()=>[r(rs,{modelValue:x.value,"onUpdate:modelValue":u[0]||(u[0]=f=>x.value=f),class:"canvas-panel__tabs","show-arrows":"",color:"primary"},{default:i(()=>[(g(!0),V(Z,null,re([...h(a),...h(o)],f=>(g(),W(Ye,{key:f.id,value:f.id,class:"text-subtitle-2 font-weight-medium text-capitalize"},{default:i(()=>[p("div",Fi,[r(pe,{size:"18"},{default:i(()=>[b(O(f.isViewer?"mdi-eye-outline":"mdi-notebook-outline"),1)]),_:2},1024),p("span",null,O(f.name),1),r(G,{size:"x-small",icon:"mdi-close",variant:"text",color:"primary",loading:_(f.id),disabled:_(f.id),onClick:Fe(v=>N(f),["stop"])},null,8,["loading","disabled","onClick"])])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),r(os,{modelValue:x.value,"onUpdate:modelValue":u[1]||(u[1]=f=>x.value=f),class:"canvas-panel__window"},{default:i(()=>[(g(!0),V(Z,null,re([...h(a),...h(o)],f=>(g(),W(Ze,{key:f.id,value:f.id},{default:i(()=>{var v;return[p("div",Di,[f.isViewer?(g(),V("div",Ni,[r(Vs)])):(g(),V(Z,{key:1},[A(f.id)?(g(),V("div",Pi,[r(Be,{color:"primary",size:"36",indeterminate:""})])):((v=f.outputs)==null?void 0:v.length)===0?(g(),V("div",Mi,[r(ss,{class:"canvas-panel__empty-sheet",color:"white",variant:"outlined"},{default:i(()=>[r(we,{color:"primary",size:"56",variant:"flat"},{default:i(()=>[r(pe,{size:"28",color:"white"},{default:i(()=>[...u[4]||(u[4]=[b("mdi-compass-outline",-1)])]),_:1})]),_:1}),u[5]||(u[5]=p("h3",{class:"text-subtitle-1 font-weight-semibold mt-4 mb-2"},"Your canvas is ready",-1)),u[6]||(u[6]=p("p",{class:"text-body-2 text-medium-emphasis mb-0"}," Trigger a tool from the left panel to see fresh content appear here. ",-1))]),_:1})])):(g(),V("div",Oi,[(g(!0),V(Z,null,re(f.outputs,I=>(g(),W(Ts,{key:I.id,mcq:I,"show-actions":!0,selectable:h(y),selected:h(k)===I.id,onDelete:q,onSelect:L},null,8,["mcq","selectable","selected"]))),128))]))],64))])]}),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),Ui=he(Li,[["__scopeId","data-v-62e6a4e4"]]),qi={class:"studio-page"},Gi={class:"studio-page__workspace"},zi=ge({__name:"StudioPage",setup(e){const t=Oe(),s=Ue(),a=Vt(),o=ee(),l=ct(),n=kt(),{appName:d,tagline:c}=oe(t),{workspaces:m}=oe(a),{workspaceId:y}=oe(o),k=$(()=>{const _=n.query.workspaceId;return Array.isArray(_)?_[0]:_||""}),x=()=>{let _=k.value,A="";if(!_&&m.value.length>0&&(_=m.value[0].id,A=m.value[0].name),_){const P=m.value.find(N=>N.id===_);P&&(A=P.name)}if(!_){o.resetWorkspace();return}o.setWorkspace({id:_,name:A}),s.loadProjectCanvases({projectId:_,force:!0}).catch(()=>{})},T=()=>{l.setHeader({title:d.value,description:c.value,actions:[{id:"studio-go-questions",label:"Go to Questions Library",icon:"mdi-file-document-multiple-outline",variant:"text",to:{name:"Questions"}}]})};return Ae(()=>{s.initialise(),typeof a.initialise=="function"&&a.initialise(),x(),T()}),Jt(()=>{x(),T()}),Yt(()=>{l.resetHeader()}),tt(()=>{l.resetHeader()}),se([k,m],()=>{x()}),se(y,_=>{s.loadProjectCanvases({projectId:_,force:!0}).catch(()=>{})},{immediate:!0}),se([d,c],()=>T()),(_,A)=>(g(),V("div",qi,[r(ot,{fluid:"",class:"studio-page__content"},{default:i(()=>[p("div",Gi,[r(Ko,{class:"studio-page__workspace-panel"}),r(Ui,{class:"studio-page__workspace-canvas"})])]),_:1})]))}}),Wi=he(zi,[["__scopeId","data-v-2aefaf3f"]]),Qi={class:"questions-page"},Ri={class:"filters-card__actions"},ji={class:"results-card__header"},Bi={key:0,class:"state state--loading"},Hi={key:1,class:"state state--empty"},Xi={key:2,class:"results-card__list"},Ki={class:"results-card__footer-controls"},Ji=ge({__name:"QuestionsPage",setup(e){const t=Ja(),s=Vt(),a=ee(),{loading:o,uniqueTags:l,filteredQuestions:n,resultsSummary:d,sessionsLoading:c,exportDialogOpen:m,exportFormat:y,exportFileName:k,exporting:x}=oe(t),{workspaces:T}=oe(s),_=$(()=>t.totalQuestions),A=ct(),P=$({get:()=>t.filters.searchQuery,set:U=>t.setSearchQuery(U)}),N=$({get:()=>t.filters.type,set:U=>t.setFilterType(U)}),S=$({get:()=>t.filters.difficulty,set:U=>t.setFilterDifficulty(U)}),D=$({get:()=>t.filters.tag,set:U=>t.setFilterTag(U)}),q=$({get:()=>t.filters.workspaceId,set:U=>t.setFilterWorkspace(U)}),L=$({get:()=>t.filters.sessionId,set:U=>t.setFilterSession(U)}),F=$({get:()=>t.filters.approved,set:U=>t.setFilterApproved(U)}),u=$({get:()=>t.filters.archived,set:U=>t.setFilterArchived(U)}),f=$({get:()=>t.filters.hasVariants,set:U=>t.setFilterHasVariants(U)}),v=$({get:()=>t.page,set:U=>t.setPage(U)}),I=$({get:()=>t.pageSize,set:U=>t.setPageSize(U)}),M=$(()=>t.pageCount),H=[{title:"All types",value:"all"},{title:"Multiple Choice (single answer)",value:"mcq"},{title:"Multiple Response",value:"multiple_response"},{title:"True False",value:"true_false"}],J=[{title:"All levels",value:"all"},{title:"Easy",value:"easy"},{title:"Medium",value:"medium"},{title:"Hard",value:"hard"}],K=$(()=>[{title:"All tags",value:"all"},...l.value.map(U=>({title:U,value:U}))]),z=$(()=>{const U=Array.isArray(T.value)?T.value:[];return[{title:"All workspaces",value:"all"},...U.map(E=>({title:E.name,value:E.id}))]}),C=$(()=>{const U=t.sessionsForWorkspace(q.value);return[{title:"All canvases",value:"all"},...U.map(E=>({title:E.name,value:E.id}))]}),j=[{title:"All statuses",value:"all"},{title:"Approved",value:"true"},{title:"Not approved",value:"false"}],ae=[{title:"Only active",value:"false"},{title:"All",value:"all"},{title:"Only archived",value:"true"}],ke=[{title:"All questions",value:"all"},{title:"With variants only",value:"true"}],qe=[{title:"20 per page",value:20},{title:"40 per page",value:40},{title:"60 per page",value:60},{title:"80 per page",value:80},{title:"100 per page",value:100}],Pe=()=>{t.resetFilters(),Se()},Ie=U=>{var E,Q;return{id:U.id,question:U.question,options:(E=U.options)!=null?E:[],correctOptions:(Q=U.correct_options)!=null?Q:[],difficultyLevel:U.difficulty_level,aiRational:U.ai_rational,source:U.source,type:U.type,tag:U.tag,variants:U.variants||[]}};let de=null;const Se=(U=300)=>{de&&clearTimeout(de),de=setTimeout(()=>{t.fetchQuestions()},U)};return tt(()=>{de&&(clearTimeout(de),de=null)}),se(P,()=>{Se(400)}),se([N,S,D,F,u,L,f],()=>{Se()}),se(q,async U=>{await t.fetchSessionsForWorkspace(U),Se()},{immediate:!0}),se(v,()=>{Se(0)}),se(I,()=>{Se(0)}),Ae(async()=>{typeof s.initialise=="function"&&await s.initialise(),a.workspaceId&&(t.setFilterWorkspace(a.workspaceId),await t.fetchSessionsForWorkspace(a.workspaceId)),await t.fetchQuestions(),A.setHeader({title:"Question Library",description:"Browse and refine every prompt your team has generated.",showBack:!0})}),tt(()=>{de&&(clearTimeout(de),de=null),A.resetHeader()}),(U,E)=>(g(),V("div",Qi,[r(ot,{fluid:"",class:"questions-page__content"},{default:i(()=>[r(st,{class:"questions-page__grid",align:"stretch",justify:"stretch"},{default:i(()=>[r(ce,{cols:"12",md:"4",lg:"3",class:"questions-page__filters"},{default:i(()=>[r(ie,{elevation:"2",class:"filters-card"},{default:i(()=>[r(je,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[...E[14]||(E[14]=[b("Filters",-1)])]),_:1}),r(Nt,{class:"text-body-2 text-medium-emphasis"},{default:i(()=>[...E[15]||(E[15]=[b(" Narrow down the library by attributes. ",-1)])]),_:1})]),_:1}),r(me,{class:"pt-0 filters-card__body"},{default:i(()=>[r(_e,{modelValue:P.value,"onUpdate:modelValue":E[0]||(E[0]=Q=>P.value=Q),label:"Search questions",variant:"solo",color:"primary","prepend-inner-icon":"mdi-magnify","hide-details":"",density:"comfortable",class:"filters-card__full mb-4"},null,8,["modelValue"]),r(st,{class:"filters-card__grid",dense:""},{default:i(()=>[r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:N.value,"onUpdate:modelValue":E[1]||(E[1]=Q=>N.value=Q),items:H,"item-title":"title","item-value":"value",label:"Question type",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:S.value,"onUpdate:modelValue":E[2]||(E[2]=Q=>S.value=Q),items:J,"item-title":"title","item-value":"value",label:"Difficulty",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:q.value,"onUpdate:modelValue":E[3]||(E[3]=Q=>q.value=Q),items:z.value,"item-title":"title","item-value":"value",label:"Workspace",variant:"solo",density:"comfortable","hide-details":"","menu-props":{maxHeight:240}},null,8,["modelValue","items"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:L.value,"onUpdate:modelValue":E[4]||(E[4]=Q=>L.value=Q),items:C.value,"item-title":"title","item-value":"value",label:"Canvas",variant:"solo",density:"comfortable","hide-details":"","menu-props":{maxHeight:240},loading:h(c),disabled:q.value==="all"},null,8,["modelValue","items","loading","disabled"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:F.value,"onUpdate:modelValue":E[5]||(E[5]=Q=>F.value=Q),items:j,"item-title":"title","item-value":"value",label:"Approval status",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:u.value,"onUpdate:modelValue":E[6]||(E[6]=Q=>u.value=Q),items:ae,"item-title":"title","item-value":"value",label:"Archived",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:f.value,"onUpdate:modelValue":E[7]||(E[7]=Q=>f.value=Q),items:ke,"item-title":"title","item-value":"value",label:"Variants",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),r(ce,{cols:"12",sm:"6"},{default:i(()=>[r(ye,{modelValue:D.value,"onUpdate:modelValue":E[8]||(E[8]=Q=>D.value=Q),items:K.value,"item-title":"title","item-value":"value",label:"Tag",variant:"solo",density:"comfortable","hide-details":"","menu-props":{maxHeight:240}},null,8,["modelValue","items"])]),_:1})]),_:1}),p("div",Ri,[r(G,{variant:"outlined",color:"primary","prepend-icon":"mdi-refresh",onClick:Pe},{default:i(()=>[...E[16]||(E[16]=[b(" Reset Filters ",-1)])]),_:1})])]),_:1})]),_:1}),r(G,{color:"primary",class:"mt-4","prepend-icon":"mdi-export",onClick:h(t).openExportDialog},{default:i(()=>[...E[17]||(E[17]=[b(" Export Questions ",-1)])]),_:1},8,["onClick"])]),_:1}),r(ce,{cols:"12",md:"8",lg:"9",class:"questions-page__results"},{default:i(()=>[r(ie,{elevation:"2",class:"results-card"},{default:i(()=>[r(je,null,{default:i(()=>[p("div",ji,[p("div",null,[r(Ce,{class:"text-h6 font-weight-semibold mb-1"},{default:i(()=>[...E[18]||(E[18]=[b("Results",-1)])]),_:1}),r(Nt,{class:"text-body-2 text-medium-emphasis"},{default:i(()=>[b(O(h(d)),1)]),_:1})])])]),_:1}),r(ve),r(me,{class:"results-card__body"},{default:i(()=>[h(o)?(g(),V("div",Bi,[r(Be,{indeterminate:"",color:"primary",size:"32"}),E[19]||(E[19]=p("p",{class:"text-body-2 text-medium-emphasis mt-4 mb-0"},"Loading questions",-1))])):h(n).length===0?(g(),V("div",Hi,[r(we,{color:"primary",size:"56",variant:"flat"},{default:i(()=>[r(pe,{size:"28",color:"white"},{default:i(()=>[...E[20]||(E[20]=[b("mdi-database-search",-1)])]),_:1})]),_:1}),E[21]||(E[21]=p("h3",{class:"text-subtitle-1 font-weight-semibold mt-4 mb-2"},"No questions match",-1)),E[22]||(E[22]=p("p",{class:"text-body-2 text-medium-emphasis mb-0"}," Adjust your filters or generate fresh content to fill the library. ",-1))])):(g(),V("div",Xi,[(g(!0),V(Z,null,re(h(n),Q=>(g(),W(Ts,{key:Q.id,mcq:Ie(Q),"show-actions":!1},null,8,["mcq"]))),128))]))]),_:1}),_.value>0?(g(),W(ve,{key:0})):X("",!0),_.value>0?(g(),W(De,{key:1,class:"results-card__footer"},{default:i(()=>[p("div",Ki,[r(ye,{modelValue:I.value,"onUpdate:modelValue":E[9]||(E[9]=Q=>I.value=Q),items:qe,"item-title":"title","item-value":"value",label:"Items per page",variant:"solo",density:"comfortable","hide-details":"",class:"results-card__page-size"},null,8,["modelValue"])]),r(ca,{modelValue:v.value,"onUpdate:modelValue":E[10]||(E[10]=Q=>v.value=Q),length:M.value,disabled:M.value<=1,color:"primary",variant:"tonal",density:"comfortable"},null,8,["modelValue","length","disabled"])]),_:1})):X("",!0)]),_:1}),r(Re,{modelValue:h(m),"onUpdate:modelValue":E[13]||(E[13]=Q=>ue(m)?m.value=Q:null),"max-width":"480",persistent:""},{default:i(()=>[r(ie,null,{default:i(()=>[r(Ce,{class:"text-h6 font-weight-semibold"},{default:i(()=>[...E[23]||(E[23]=[b(" Export Questions ",-1)])]),_:1}),r(me,null,{default:i(()=>[r(ua,{modelValue:h(y),"onUpdate:modelValue":E[11]||(E[11]=Q=>ue(y)?y.value=Q:null),label:"Select export format",class:"mb-4"},{default:i(()=>[r(Pt,{label:"CSV (.csv)",value:"csv"}),r(Pt,{label:"QTI (IMS ZIP)",value:"qti"})]),_:1},8,["modelValue"]),r(_e,{modelValue:h(k),"onUpdate:modelValue":E[12]||(E[12]=Q=>ue(k)?k.value=Q:null),label:"File name",variant:"outlined","prepend-inner-icon":"mdi-file",density:"comfortable"},null,8,["modelValue"])]),_:1}),r(De,{class:"justify-end"},{default:i(()=>[r(G,{variant:"text",onClick:h(t).closeExportDialog},{default:i(()=>[...E[24]||(E[24]=[b(" Cancel ",-1)])]),_:1},8,["onClick"]),r(G,{color:"primary",variant:"flat",loading:h(x),disabled:!h(k),onClick:h(t).exportQuestions},{default:i(()=>[...E[25]||(E[25]=[b(" Export ",-1)])]),_:1},8,["loading","disabled","onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]))}}),Yi=he(Ji,[["__scopeId","data-v-f7357008"]]),Zi={class:"login-page"},en={class:"login-card__brand"},tn=ge({__name:"LoginPage",setup(e){const t=kt(),s=wt(),a=ne(),o=Y(""),l=Y(""),n=$(()=>a.loading),d=$(()=>{var m;return((m=a.error)==null?void 0:m.message)||""}),c=async()=>{if(!n.value)try{await a.signIn({username:o.value,password:l.value});const m=typeof t.query.redirect=="string"?t.query.redirect:void 0;m?s.replace(m):s.replace({name:"Dashboard"})}catch{}};return(m,y)=>(g(),V("div",Zi,[r(ie,{class:"login-card",elevation:"8"},{default:i(()=>[p("div",en,[r(we,{size:"56",color:"primary",variant:"flat"},{default:i(()=>[...y[2]||(y[2]=[p("span",{class:"text-h6 font-weight-bold text-white"},"EM",-1)])]),_:1}),y[3]||(y[3]=p("div",null,[p("p",{class:"login-card__eyebrow"},"EduMind Studio"),p("h1",{class:"login-card__title"},"Sign in to continue"),p("p",{class:"login-card__subtitle"},"Use the credentials shared with your team lead.")],-1))]),r(as,{class:"login-card__form",onSubmit:Fe(c,["prevent"])},{default:i(()=>[r(_e,{modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=k=>o.value=k),label:"Username",variant:"outlined",density:"comfortable",autocomplete:"username",required:"",disabled:n.value},null,8,["modelValue","disabled"]),r(_e,{modelValue:l.value,"onUpdate:modelValue":y[1]||(y[1]=k=>l.value=k),label:"Password",variant:"outlined",density:"comfortable",type:"password",autocomplete:"current-password",required:"",disabled:n.value},null,8,["modelValue","disabled"]),d.value?(g(),W(be,{key:0,type:"error",variant:"tonal",density:"comfortable"},{default:i(()=>[b(O(d.value),1)]),_:1})):X("",!0),r(G,{color:"primary",variant:"flat",block:"",size:"large",type:"submit",loading:n.value,disabled:n.value},{default:i(()=>[...y[4]||(y[4]=[b(" Sign In ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]))}}),sn=he(tn,[["__scopeId","data-v-a7419875"]]),an={__name:"GraphViewerPage",setup(e){return(t,s)=>(g(),W(Vs,{style:{height:"calc(100vh - 96px)"}}))}},rn=[{path:"/",name:"Dashboard",component:jr,meta:{requiresAuth:!0}},{path:"/studio",name:"Studio",component:Wi,meta:{requiresAuth:!0}},{path:"/workspace",redirect:{name:"Studio"}},{path:"/questions",name:"Questions",component:Yi,meta:{requiresAuth:!0}},{path:"/visualizer",name:"Visualizer",component:an,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:sn,meta:{requiresAuth:!1}},{path:"/:pathMatch(.*)*",redirect:{name:"Dashboard"}}],Es=Us({history:qs("/"),routes:rn});Es.beforeEach(async(e,t,s)=>{var o;const a=ne();return!a.hydrated&&!a.loading&&await a.hydrate(),((o=e.meta)==null?void 0:o.requiresAuth)===!1?a.isAuthenticated&&e.name==="Login"?s({name:"Dashboard"}):s():a.isAuthenticated?s():s({name:"Login",query:e.fullPath?{redirect:e.fullPath}:void 0})});const Me="#166534",on={dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF",primary:Me,secondary:Me,info:Me,warning:Me,error:Me,success:Me},variables:{"font-family":"Overpass, sans-serif","border-radius-root":"16px"}},nn=pa({theme:{defaultTheme:"light",variations:{colors:["primary","secondary","accent"],lighten:2,darken:2},themes:{light:on}},icons:{defaultSet:"mdi",aliases:fa,sets:{mdi:ma}},defaults:{global:{ripple:!1},VCard:{elevation:1,rounded:"xl"},VBtn:{rounded:"lg",style:"text-transform: none; letter-spacing: 0;"}}});function ln(e){e.use(nn)}const ut=Ms($r),$s=Os();$s.use(Ls);ln(ut);ut.use($s);ut.use(Es);ut.mount("#app");
